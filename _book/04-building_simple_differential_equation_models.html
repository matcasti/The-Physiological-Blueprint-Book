<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.29">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>4&nbsp; Building Simple Differential Equation Models – The Physiological Blueprint</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./05-introduction_to_the_desolve_package.html" rel="next">
<link href="./03-thinking_dynamically_rates_of_change.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-0815c480559380816a4d1ea211a47e91.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-748b535e376f14d4692bf2b2e5fd6380.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-0815c480559380816a4d1ea211a47e91.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-485d01fc63b59abcd3ee1bf1e8e2748d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-7a339148c3b2635d23d0fec43941109e.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-485d01fc63b59abcd3ee1bf1e8e2748d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-why-model-physiology.html">Foundations in Modeling and R</a></li><li class="breadcrumb-item"><a href="./04-building_simple_differential_equation_models.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Building Simple Differential Equation Models</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="quarto-sidebar-header"><div class="sidebar-header-item">
<p>This book is currently under development</p>
</div></div>
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">The Physiological Blueprint<br><small>Modeling Biological Systems with Ordinary Differential Equations in R</small><br></a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/matcasti/The-Physiological-Blueprint-Book" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./The-Physiological-Blueprint.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./The-Physiological-Blueprint.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dedication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dedication</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Foundations in Modeling and R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-why-model-physiology.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Why Model Physiology?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-a_gentle_introduction_to_r_for_modelers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">A Gentle Introduction to R for Modelers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-thinking_dynamically_rates_of_change.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Thinking Dynamically: Rates of Change</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-building_simple_differential_equation_models.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Building Simple Differential Equation Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Solving, Simulating, and Visualizing ODEs in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-introduction_to_the_desolve_package.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to the <code>deSolve</code> Package</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-numerical_methods_for_solving_odes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Numerical Methods for Solving ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-visualizing_model_dynamics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Visualizing Model Dynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-exploring_parameter_sensitivity_and_uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Exploring Parameter Sensitivity and Uncertainty</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Modeling Specific Physiological Systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-modeling_basic_cardiovascular_dynamics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Modeling Basic Cardiovascular Dynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-introducing_autonomic_control_into_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introducing Autonomic Control into Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-modeling_exercise_responses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Modeling Exercise Responses</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-focusing_on_cardiac_autonomic_modulation_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Focusing on Cardiac Autonomic Modulation Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced Concepts and Future Directions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-building_more_complex_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Building More Complex Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-linking_models_to_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Linking Models to Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-limitations_and_future_directions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Limitations and Future Directions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix_a_r_installation_guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">R Installation Guide</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix_b_glossary_of_mathematical_and_physiological_terms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Glossary of Mathematical and Physiological Terms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix_c_solutions_or_hints_to_select_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Solutions or Hints to Select Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix_d_r_code_snippets_and_examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">R Code Snippets and Examples</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#introduction-to-ordinary-differential-equations-odes" id="toc-introduction-to-ordinary-differential-equations-odes" class="nav-link active" data-scroll-target="#introduction-to-ordinary-differential-equations-odes"><span class="header-section-number">4.1</span> Introduction to Ordinary Differential Equations (ODEs)</a></li>
  <li><a href="#components-of-an-ode-model-state-variables-parameters-and-the-rate-function" id="toc-components-of-an-ode-model-state-variables-parameters-and-the-rate-function" class="nav-link" data-scroll-target="#components-of-an-ode-model-state-variables-parameters-and-the-rate-function"><span class="header-section-number">4.2</span> Components of an ODE Model: State Variables, Parameters, and the Rate Function</a>
  <ul class="collapse">
  <li><a href="#state-variables-the-actors-in-our-dynamic-story" id="toc-state-variables-the-actors-in-our-dynamic-story" class="nav-link" data-scroll-target="#state-variables-the-actors-in-our-dynamic-story"><span class="header-section-number">4.2.1</span> State Variables: The Actors in Our Dynamic Story</a></li>
  <li><a href="#parameters-the-fixed-properties-of-the-system" id="toc-parameters-the-fixed-properties-of-the-system" class="nav-link" data-scroll-target="#parameters-the-fixed-properties-of-the-system"><span class="header-section-number">4.2.2</span> Parameters: The Fixed Properties of the System</a></li>
  <li><a href="#the-rate-function-the-rulebook-for-change" id="toc-the-rate-function-the-rulebook-for-change" class="nav-link" data-scroll-target="#the-rate-function-the-rulebook-for-change"><span class="header-section-number">4.2.3</span> The Rate Function: The Rulebook for Change</a></li>
  <li><a href="#putting-it-all-together-a-glucose-disappearance-model" id="toc-putting-it-all-together-a-glucose-disappearance-model" class="nav-link" data-scroll-target="#putting-it-all-together-a-glucose-disappearance-model"><span class="header-section-number">4.2.4</span> Putting It All Together: A Glucose Disappearance Model</a></li>
  </ul></li>
  <li><a href="#developing-simple-models-from-verbal-descriptions-of-physiological-processes" id="toc-developing-simple-models-from-verbal-descriptions-of-physiological-processes" class="nav-link" data-scroll-target="#developing-simple-models-from-verbal-descriptions-of-physiological-processes"><span class="header-section-number">4.3</span> Developing simple models from verbal descriptions of physiological processes</a>
  <ul class="collapse">
  <li><a href="#example-1-simple-substance-diffusion" id="toc-example-1-simple-substance-diffusion" class="nav-link" data-scroll-target="#example-1-simple-substance-diffusion"><span class="header-section-number">4.3.1</span> Example 1: Simple Substance Diffusion</a></li>
  <li><a href="#example-2-a-hormone-secretion-and-degradation-model-revisited" id="toc-example-2-a-hormone-secretion-and-degradation-model-revisited" class="nav-link" data-scroll-target="#example-2-a-hormone-secretion-and-degradation-model-revisited"><span class="header-section-number">4.3.2</span> Example 2: A Hormone Secretion and Degradation Model (Revisited)</a></li>
  <li><a href="#example-3-a-simple-model-of-muscle-fatigue" id="toc-example-3-a-simple-model-of-muscle-fatigue" class="nav-link" data-scroll-target="#example-3-a-simple-model-of-muscle-fatigue"><span class="header-section-number">4.3.3</span> Example 3: A Simple Model of Muscle Fatigue</a></li>
  <li><a href="#example-blood-glucose-regulation-simplified" id="toc-example-blood-glucose-regulation-simplified" class="nav-link" data-scroll-target="#example-blood-glucose-regulation-simplified"><span class="header-section-number">4.3.4</span> Example: Blood Glucose Regulation (Simplified)</a></li>
  <li><a href="#the-importance-of-assumptions" id="toc-the-importance-of-assumptions" class="nav-link" data-scroll-target="#the-importance-of-assumptions"><span class="header-section-number">4.3.5</span> The Importance of Assumptions</a></li>
  </ul></li>
  <li><a href="#examples-from-basic-to-complex-models" id="toc-examples-from-basic-to-complex-models" class="nav-link" data-scroll-target="#examples-from-basic-to-complex-models"><span class="header-section-number">4.4</span> Examples: From basic to complex models</a>
  <ul class="collapse">
  <li><a href="#example-1-a-comprehensive-exploration-of-substance-concentration-change" id="toc-example-1-a-comprehensive-exploration-of-substance-concentration-change" class="nav-link" data-scroll-target="#example-1-a-comprehensive-exploration-of-substance-concentration-change"><span class="header-section-number">4.4.1</span> Example 1: A Comprehensive Exploration of Substance Concentration Change</a></li>
  <li><a href="#example-2-a-multifaceted-model-of-muscle-fatigue" id="toc-example-2-a-multifaceted-model-of-muscle-fatigue" class="nav-link" data-scroll-target="#example-2-a-multifaceted-model-of-muscle-fatigue"><span class="header-section-number">4.4.2</span> Example 2: A Multifaceted Model of Muscle Fatigue</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/matcasti/The-Physiological-Blueprint-Book/edit/main/04-building_simple_differential_equation_models.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/matcasti/The-Physiological-Blueprint-Book/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-why-model-physiology.html">Foundations in Modeling and R</a></li><li class="breadcrumb-item"><a href="./04-building_simple_differential_equation_models.html"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Building Simple Differential Equation Models</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Building Simple Differential Equation Models</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="introduction-to-ordinary-differential-equations-odes" class="level2" data-number="4.1">
<h2 data-number="4.1" class="anchored" data-anchor-id="introduction-to-ordinary-differential-equations-odes"><span class="header-section-number">4.1</span> Introduction to Ordinary Differential Equations (ODEs)</h2>
<p>Having spent Chapter 3 delving into the fundamental concept of rates of change and how they relate to continuous time, we are now poised to formally introduce <strong>ordinary differential equations (ODEs)</strong>. As we’ve hinted, ODEs are the mathematical workhorses for building dynamic models of physiological systems. They provide a precise way to express how the instantaneous rates of change of our physiological variables are determined by the current state of the system and any external influences.</p>
<p>In essence, an ODE is an equation that involves a function and its derivatives. When we use ODEs to model a physiological system evolving over time, the function we are interested in is the time course of one or more physiological variables (e.g., heart rate as a function of time, <span class="math inline">\(HR(t)\)</span>; or glucose concentration as a function of time, <span class="math inline">\(C_{glucose}(t)\)</span>). The ODE then describes how the <em>rate of change</em> of these variables (e.g., <span class="math inline">\(\frac{dHR}{dt}\)</span>, <span class="math inline">\(\frac{dC_{glucose}}{dt}\)</span>) depends on the current values of the variables themselves, time, and any relevant parameters.</p>
<p><strong>What Makes an ODE “Ordinary”?</strong></p>
<p>The term “ordinary” in ODE signifies that the derivatives involved are with respect to a <em>single</em> independent variable, which in the context of dynamic physiological models, is almost always <strong>time (<span class="math inline">\(t\)</span>)</strong>. If a model involved rates of change with respect to more than one independent variable (e.g., both time and spatial position), it would be described by <em>partial</em> differential equations (PDEs), which are beyond the scope of this introductory book. For the physiological systems we’ll be exploring, where we’re primarily interested in how variables change <em>over time</em> within a reasonably well-mixed compartment or the system as a whole, ODEs are the appropriate tool.</p>
<p><strong>The General Form of an ODE</strong></p>
<p>A general form for a single first-order ODE (involving only the first derivative) for a variable <span class="math inline">\(x\)</span> as a function of time <span class="math inline">\(t\)</span> can be written as:</p>
<p><span class="math display">\[\frac{dx}{dt} = f(t, x, p_1, p_2, \dots)\]</span></p>
<p>Let’s break down this notation:</p>
<ul>
<li><span class="math inline">\(\frac{dx}{dt}\)</span>: This is the first derivative of the variable <span class="math inline">\(x\)</span> with respect to time <span class="math inline">\(t\)</span>, representing the instantaneous rate of change of <span class="math inline">\(x\)</span>.</li>
<li><span class="math inline">\(f(\dots)\)</span>: This represents a function that specifies how this rate of change is calculated. It can depend on:
<ul>
<li><span class="math inline">\(t\)</span>: Time itself (e.g., if there’s an explicitly time-dependent input to the system).</li>
<li><span class="math inline">\(x\)</span>: The current value of the variable <span class="math inline">\(x\)</span>. Often, the rate of change depends on how much of <span class="math inline">\(x\)</span> is currently present.</li>
<li><span class="math inline">\(p_1, p_2, \dots\)</span>: Parameters of the model. These are constants that characterize the system (e.g., rate constants, volumes, sensitivities).</li>
</ul></li>
</ul>
<p><strong>Components of an ODE Model</strong></p>
<p>From the general form above, we can identify the key components that make up an ODE model of a dynamic physiological system:</p>
<ol type="1">
<li><p><strong>State Variables:</strong> These are the physiological quantities that change over time and whose dynamics we are trying to model (e.g., heart rate, blood glucose concentration, muscle force). In our notation above, <span class="math inline">\(x\)</span> is the state variable. A model can have one or more state variables. If there are multiple, we get a system of coupled ODEs.</p></li>
<li><p><strong>Parameters:</strong> These are constant values that describe inherent properties of the physiological system being modeled (e.g., a rate constant for glucose uptake by cells, the total blood volume, the sensitivity of the baroreceptor reflex). These parameters influence the rates of change of the state variables. In our notation, <span class="math inline">\(p_1, p_2, \dots\)</span> are the parameters.</p></li>
<li><p><strong>The Rate Function (f):</strong> This is the mathematical expression that defines how the instantaneous rate of change of each state variable depends on the current values of the state variables, time (if applicable), and the parameters. This function embodies our understanding of the physiological mechanisms driving the changes. For each state variable in the model, there will be a corresponding rate function (an ODE).</p></li>
</ol>
<p><strong>Order of an ODE</strong></p>
<p>The order of a differential equation is determined by the highest derivative that appears in it. The equation <span class="math inline">\(\frac{dx}{dt} = f(\dots)\)</span> is a <strong>first-order ODE</strong> because it only involves the first derivative. We will primarily focus on first-order ODEs in this introductory text, as many fundamental physiological processes can be effectively modeled using them. Higher-order ODEs (involving <span class="math inline">\(\frac{d^2x}{dt^2}\)</span>, <span class="math inline">\(\frac{d^3x}{dt^3}\)</span>, etc.) can model more complex dynamics, such as oscillations or inertia-like effects, but their introduction will be more gradual if needed later.</p>
<p><strong>Linear vs.&nbsp;Nonlinear ODEs</strong></p>
<p>Another important distinction is between linear and nonlinear ODEs.</p>
<ul>
<li><p>An ODE is <strong>linear</strong> if the function <span class="math inline">\(f\)</span> is a linear combination of the state variable(s) and any time-dependent terms. For a single variable <span class="math inline">\(x\)</span>, a linear first-order ODE would generally look like <span class="math inline">\(\frac{dx}{dt} = a(t)x + b(t)\)</span>, where <span class="math inline">\(a(t)\)</span> and <span class="math inline">\(b(t)\)</span> are functions of time (or constants). The exponential growth and decay models we saw in Chapter 3 (<span class="math inline">\(\frac{dN}{dt} = rN\)</span> and <span class="math inline">\(\frac{dX}{dt} = -kX\)</span>) are examples of linear ODEs.</p></li>
<li><p>An ODE is <strong>nonlinear</strong> if the function <span class="math inline">\(f\)</span> involves the state variable(s) in a nonlinear way (e.g., <span class="math inline">\(x^2\)</span>, <span class="math inline">\(\sin(x)\)</span>, <span class="math inline">\(x \cdot y\)</span> if <span class="math inline">\(y\)</span> is another state variable). Many biologically interesting models are nonlinear, as they often involve saturations, thresholds, or interactions between variables that are not simply additive. The logistic growth model mentioned earlier is a nonlinear ODE due to the <span class="math inline">\(N^2\)</span> term when expanded.</p></li>
</ul>
<p>The distinction between linear and nonlinear ODEs is significant because linear ODEs often have analytical solutions (mathematical formulas for <span class="math inline">\(x(t)\)</span>), whereas nonlinear ODEs generally do not and must be solved numerically (which is where tools like R’s <code>deSolve</code> package become essential).</p>
<p><strong>From Physiology to ODEs: The Modeling Process</strong></p>
<p>How do we go from a physiological understanding of a system to a set of ODEs? This involves several steps:</p>
<ol type="1">
<li><p><strong>Identify the State Variables:</strong> What are the key quantities that change over time and are crucial for describing the system’s behavior? For example, if we’re modeling glucose regulation, key state variables might include blood glucose concentration and insulin concentration. For a simple model of heart rate response to exercise, the state variable might just be heart rate itself (or perhaps heart rate above resting).</p></li>
<li><p><strong>Determine the Factors Influencing the Rate of Change:</strong> For each state variable, what physiological processes cause it to increase or decrease? Think about fluxes, conversions, regulations. For blood glucose, the rate of change is influenced by glucose entry (from the gut, liver), glucose uptake by tissues, and insulin’s effects on these processes. For heart rate, the rate of change is influenced by autonomic nervous system activity (sympathetic and parasympathetic input).</p></li>
<li><p><strong>Formulate the Rate Functions:</strong> Express these influences mathematically as functions of the state variables, parameters, and possibly time. This is where our physiological knowledge translates into mathematical equations. For example, we might say that the rate of glucose uptake by muscle is proportional to the blood glucose concentration and modulated by insulin levels. This would become part of the rate function for blood glucose.</p></li>
<li><p><strong>Define the Parameters:</strong> Identify the constant values that characterize the system, such as rate constants, volumes of compartments, sensitivities of responses, etc. These often need to be estimated from experimental data or taken from the literature.</p></li>
</ol>
<p>The result of these steps is a system of one or more ODEs that, we hope, captures the essential dynamics of the physiological system we are interested in.</p>
<p><strong>Simple ODE Examples in Physiology (Revisited and Expanded)</strong></p>
<p>Let’s revisit the simple examples from Chapter 3, now explicitly framing them as ODEs and highlighting their components:</p>
<p><strong>1. Simple Exponential Decay (First-Order Clearance)</strong></p>
<ul>
<li><p><strong>State Variable:</strong> Concentration of a drug, <span class="math inline">\(C(t)\)</span>.</p></li>
<li><p><strong>Parameters:</strong> Clearance rate constant, <span class="math inline">\(k &gt; 0\)</span>.</p></li>
<li><p><strong>Rate Function:</strong> <span class="math inline">\(\frac{dC}{dt} = -kC(t)\)</span></p>
<p>This ODE states that the rate of change of the drug concentration is directly proportional to the current concentration, with a negative sign indicating decay. The parameter <span class="math inline">\(k\)</span> dictates how quickly the decay occurs.</p></li>
</ul>
<p><strong>2. First-Order Approach to a Setpoint (e.g., Heart Rate Response)</strong></p>
<ul>
<li><p><strong>State Variable:</strong> Heart rate, <span class="math inline">\(HR(t)\)</span>.</p></li>
<li><p><strong>Parameters:</strong> Target heart rate (setpoint), <span class="math inline">\(HR_{target}\)</span>; rate constant, <span class="math inline">\(k &gt; 0\)</span>.</p></li>
<li><p><strong>Rate Function:</strong> <span class="math inline">\(\frac{dHR}{dt} = k (HR_{target} - HR(t))\)</span></p>
<p>This ODE describes how heart rate changes over time to approach a target value. If <span class="math inline">\(HR(t)\)</span> is below <span class="math inline">\(HR_{target}\)</span>, the rate of change is positive (HR increases); if above, it’s negative (HR decreases). The rate of change is proportional to the difference between the current HR and the target HR, with <span class="math inline">\(k\)</span> determining the speed of this adjustment.</p></li>
</ul>
<p><strong>3. Simple Exponential Growth (e.g., Initial Cell Proliferation)</strong></p>
<ul>
<li><p><strong>State Variable:</strong> Number of cells, <span class="math inline">\(N(t)\)</span>.</p></li>
<li><p><strong>Parameters:</strong> Growth rate constant, <span class="math inline">\(r &gt; 0\)</span>.</p></li>
<li><p><strong>Rate Function:</strong> <span class="math inline">\(\frac{dN}{dt} = rN(t)\)</span></p>
<p>This ODE models unchecked growth where the rate of increase in cell number is proportional to the current number of cells.</p></li>
</ul>
<p><strong>A Slightly More Complex Example: A Two-Compartment Model</strong></p>
<p>To illustrate a system of ODEs, consider a very simplified model of a hormone (H) being secreted into the bloodstream (Compartment 1) at a constant rate (<span class="math inline">\(S\)</span>) and then eliminated from the bloodstream at a rate proportional to its concentration in the blood. Let <span class="math inline">\(H_1(t)\)</span> be the concentration of the hormone in the bloodstream.</p>
<ul>
<li><strong>State Variable 1:</strong> Hormone concentration in blood, <span class="math inline">\(H_1(t)\)</span>.</li>
<li><strong>Parameters:</strong> Secretion rate, <span class="math inline">\(S\)</span>; elimination rate constant, <span class="math inline">\(k_e\)</span>.</li>
</ul>
<p>The ODE for <span class="math inline">\(H_1\)</span> would be:</p>
<p><span class="math display">\[\frac{dH_1}{dt} = S - k_e H_1(t)\]</span></p>
<p>Here, the rate of change of <span class="math inline">\(H_1\)</span> is determined by two processes: a constant positive input (secretion, <span class="math inline">\(S\)</span>) and a negative output proportional to the current concentration (elimination, <span class="math inline">\(-k_e H_1\)</span>). This is a simple example of how multiple processes can be combined in an ODE to describe the net rate of change.</p>
<p>We could even add a second compartment, say the interstitial fluid (Compartment 2), with hormone concentration <span class="math inline">\(H_2(t)\)</span>, and model the movement of the hormone between the two compartments. If the movement from blood to interstitial fluid is proportional to <span class="math inline">\(H_1\)</span> and the movement back is proportional to <span class="math inline">\(H_2\)</span>, we would get a system of two coupled ODEs:</p>
<p><span class="math display">\[\frac{dH_1}{dt} = S - k_e H_1(t) - k_{12} H_1(t) + k_{21} H_2(t)\]</span><span class="math display">\[\frac{dH_2}{dt} = k_{12} H_1(t) - k_{21} H_2(t)\]</span></p>
<p>Here, <span class="math inline">\(k_{12}\)</span> and <span class="math inline">\(k_{21}\)</span> are rate constants for the movement between compartments. Notice how the rate of change of <span class="math inline">\(H_1\)</span> depends on <span class="math inline">\(H_2\)</span>, and vice versa, making them a coupled system.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Physiological Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>Many physiological processes involve multiple interacting compartments or variables. For instance, modeling glucose-insulin dynamics requires considering the concentrations of both glucose and insulin, and how they influence each other’s rates of change. These interactions are naturally captured by systems of coupled ODEs.</p>
</div>
</div>
<p><strong>Solving ODEs: Finding the Time Course</strong></p>
<p>The “solution” to an ODE (or a system of ODEs) is the function (or set of functions) that describes how the state variable(s) change over time, <span class="math inline">\(x(t)\)</span> (or <span class="math inline">\(H_1(t)\)</span> and <span class="math inline">\(H_2(t)\)</span> in the two-compartment example), and that satisfies the differential equation(s).</p>
<p>For some simple ODEs (like the basic exponential growth and decay), we can find analytical solutions using calculus. For example, the solution to <span class="math inline">\(\frac{dX}{dt} = -kX\)</span> with initial condition <span class="math inline">\(X(0) = X_0\)</span> is <span class="math inline">\(X(t) = X_0 e^{-kt}\)</span>. You can verify this by taking the derivative of <span class="math inline">\(X(t)\)</span> with respect to <span class="math inline">\(t\)</span> and seeing that it equals <span class="math inline">\(-kX(t)\)</span>.</p>
<p>However, for many ODEs, especially nonlinear ones or systems of multiple coupled ODEs, finding an analytical solution is difficult or impossible. This is where numerical methods come in. Numerical solvers, like those implemented in R’s <code>deSolve</code> package, approximate the solution by stepping through time in small increments, using the rate of change defined by the ODEs to estimate the value of the state variables at the next time point. We will delve into this more in Part 2.</p>
<p><strong>The Importance of Initial Conditions</strong></p>
<p>To get a unique solution to an ODE, we need to specify the <strong>initial condition(s)</strong> – the value(s) of the state variable(s) at the starting time (usually <span class="math inline">\(t=0\)</span>). For a first-order ODE like <span class="math inline">\(\frac{dx}{dt} = f(t, x, \dots)\)</span>, we typically need one initial condition, <span class="math inline">\(x(t_0) = x_0\)</span>. For a system of <span class="math inline">\(n\)</span> first-order ODEs, we would need <span class="math inline">\(n\)</span> initial conditions, one for each state variable. The initial conditions tell the model where to start its dynamic evolution.</p>
<p>For our hormone example with two compartments, to simulate the system, we would need initial concentrations for both <span class="math inline">\(H_1(0)\)</span> and <span class="math inline">\(H_2(0)\)</span>.</p>
<p><strong>Looking Ahead</strong></p>
<p>So far we’ve laid the groundwork for understanding what ODEs are, their components (state variables, parameters, rate functions), and the distinction between linear and nonlinear ODEs. We’ve also seen some simple physiological examples. In the next section, we will take the next step and focus on how to develop these simple models from verbal descriptions of physiological processes – how to translate our biological intuition into the mathematical language of ODEs. This will set us up to then use R to simulate and explore the behavior of these dynamic models.</p>
</section>
<section id="components-of-an-ode-model-state-variables-parameters-and-the-rate-function" class="level2" data-number="4.2">
<h2 data-number="4.2" class="anchored" data-anchor-id="components-of-an-ode-model-state-variables-parameters-and-the-rate-function"><span class="header-section-number">4.2</span> Components of an ODE Model: State Variables, Parameters, and the Rate Function</h2>
<p>In the previous section, we introduced the concept of ordinary differential equations (ODEs) as the language we’ll use to create our physiological blueprints. We saw that an ODE relates a function (our physiological variable of interest) to its derivatives with respect to a single independent variable, time. Now, let’s dissect the fundamental building blocks that constitute an ODE model: <strong>state variables</strong>, <strong>parameters</strong>, and the <strong>rate function</strong>. Understanding these components is crucial for both interpreting existing models and constructing your own.</p>
<section id="state-variables-the-actors-in-our-dynamic-story" class="level3" data-number="4.2.1">
<h3 data-number="4.2.1" class="anchored" data-anchor-id="state-variables-the-actors-in-our-dynamic-story"><span class="header-section-number">4.2.1</span> State Variables: The Actors in Our Dynamic Story</h3>
<p>State variables are the core of any dynamic model. They represent the <strong>quantities within our physiological system that change over time</strong> and whose behavior we want to understand or predict. These are the “actors” in the dynamic story our model tells.</p>
<ul>
<li><p><strong>What they represent:</strong> State variables are typically measurable physiological quantities, such as:</p>
<ul>
<li>Concentration of a substance (e.g., glucose, a hormone, a drug) in a compartment (e.g., blood, interstitial fluid, a cell).</li>
<li>The amount or mass of a substance in a compartment.</li>
<li>Physiological rates (e.g., heart rate, oxygen consumption).</li>
<li>Pressures (e.g., blood pressure).</li>
<li>Volumes (e.g., lung volume).</li>
<li>Levels of activation (e.g., muscle activation, receptor occupancy).</li>
</ul></li>
<li><p><strong>How they evolve:</strong> The ODEs in our model will describe the <em>rates of change</em> of these state variables. By solving these equations (either analytically or numerically), we can determine how the values of these state variables evolve over time, starting from some initial condition. This time evolution is the model’s prediction of the system’s dynamics.</p></li>
<li><p><strong>Multiple State Variables:</strong> A model can have one state variable (a single ODE) or multiple state variables (a system of coupled ODEs). Coupled ODEs describe how the rates of change of multiple state variables depend on each other, reflecting the interconnectedness of physiological processes. For instance, a model of glucose-insulin dynamics would likely have at least two state variables: blood glucose concentration and plasma insulin concentration, with their rates of change influencing each other.</p></li>
<li><p><strong>Notation:</strong> We typically denote state variables using symbols like <span class="math inline">\(x(t)\)</span>, <span class="math inline">\(y(t)\)</span>, <span class="math inline">\(C(t)\)</span>, <span class="math inline">\(HR(t)\)</span>, where the <span class="math inline">\((t)\)</span> emphasizes that their values change with time. If we have multiple state variables, we might use subscripts, e.g., <span class="math inline">\(x_1(t)\)</span>, <span class="math inline">\(x_2(t)\)</span>, or use different symbols for each (like <span class="math inline">\(G(t)\)</span> for glucose and <span class="math inline">\(I(t)\)</span> for insulin).</p></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Physiological Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>When you think about a physiological question you want to model, the first step is often to identify the key measurable quantities that are changing and are central to your question. These will likely become your state variables. For example, if you’re interested in how heart rate responds to exercise, <span class="math inline">\(HR(t)\)</span> is a natural state variable. If you’re modeling drug pharmacokinetics, the drug concentration in the blood or a target tissue would be a state variable.</p>
</div>
</div>
</section>
<section id="parameters-the-fixed-properties-of-the-system" class="level3" data-number="4.2.2">
<h3 data-number="4.2.2" class="anchored" data-anchor-id="parameters-the-fixed-properties-of-the-system"><span class="header-section-number">4.2.2</span> Parameters: The Fixed Properties of the System</h3>
<p>Parameters are the <strong>constant values</strong> within our ODE model that characterize the inherent properties or constraints of the physiological system we are modeling. Unlike state variables, parameters do not change over time <em>within a single simulation</em>. However, by changing the values of parameters between different simulations, we can explore how these underlying properties affect the system’s dynamic behavior.</p>
<ul>
<li><p><strong>What they represent:</strong> Parameters often correspond to:</p>
<ul>
<li>Rate constants of processes (e.g., the rate of glucose uptake, the rate of hormone degradation).</li>
<li>Physical constants (e.g., body temperature, if assumed constant).</li>
<li>Physiological properties (e.g., blood volume, sensitivity of a receptor).</li>
<li>External inputs that are held constant during a simulation (e.g., a constant infusion rate of a drug).</li>
<li>Setpoints or target values in regulatory mechanisms (as seen in the first-order approach example).</li>
</ul></li>
<li><p><strong>Influence on Dynamics:</strong> Parameters dictate the <em>magnitude</em> and <em>speed</em> of the processes described by the rate functions. A change in a parameter’s value can lead to qualitatively or quantitatively different dynamic behaviors of the state variables. For example, a higher clearance rate constant for a drug will result in a faster decay of its concentration. A higher sensitivity of the baroreflex might lead to a more rapid adjustment of heart rate in response to blood pressure changes.</p></li>
<li><p><strong>Estimation:</strong> The values of parameters often need to be estimated from experimental data or obtained from the scientific literature. This process of <strong>parameter identification</strong> or <strong>model fitting</strong> is a crucial aspect of mathematical modeling in physiology, as the accuracy of the model’s predictions depends on the appropriate choice of parameter values. We will touch upon this in later chapters.</p></li>
<li><p><strong>Notation:</strong> Parameters are typically denoted by letters from the middle or end of the alphabet (e.g., <span class="math inline">\(k, r, V_{max}, K_m, S\)</span>). Sometimes, they have subscripts to indicate what they represent (e.g., <span class="math inline">\(k_{deg}\)</span> for a degradation rate constant).</p></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
R Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>When you implement your ODE model in R (which we’ll do using the <code>deSolve</code> package), you’ll usually define the parameters as a named vector. This makes it easy to refer to them within your rate functions.</p>
</div>
</div>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>parameters <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">k_clearance =</span> <span class="fl">0.1</span>, <span class="co"># Clearance rate constant (per minute)</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">HR_target =</span> <span class="dv">120</span>    <span class="co"># Target heart rate (bpm)</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Physiological Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>Think of parameters as the “settings” of your physiological system. They define the inherent rules and capacities. For instance, the strength of the heart muscle, the sensitivity of insulin receptors, or the rate at which enzymes can catalyze reactions are all properties that can be represented by parameters in a model.</p>
</div>
</div>
</section>
<section id="the-rate-function-the-rulebook-for-change" class="level3" data-number="4.2.3">
<h3 data-number="4.2.3" class="anchored" data-anchor-id="the-rate-function-the-rulebook-for-change"><span class="header-section-number">4.2.3</span> The Rate Function: The Rulebook for Change</h3>
<p>The rate function, often denoted as <span class="math inline">\(f\)</span> in our general ODE form (<span class="math inline">\(\frac{dx}{dt} = f(\dots)\)</span>), is the heart of the ODE model. It’s a mathematical expression that <strong>specifies how the instantaneous rate of change of a state variable is determined</strong> at any given time. This function incorporates the current values of the state variables, the parameters, and possibly time itself to calculate <span class="math inline">\(\frac{dx}{dt}\)</span>.</p>
<ul>
<li><p><strong>Describing Mechanisms:</strong> The form of the rate function reflects our understanding of the underlying physiological mechanisms that cause the state variable to increase or decrease. It encodes the rules of interaction within the system. For example:</p>
<ul>
<li>If a substance is being produced at a constant rate and degraded at a rate proportional to its concentration, the rate function for the concentration <span class="math inline">\(C\)</span> might look like <span class="math inline">\(\frac{dC}{dt} = P - kC\)</span>, where <span class="math inline">\(P\)</span> is the production rate (a parameter) and <span class="math inline">\(k\)</span> is the degradation rate constant (another parameter).</li>
<li>If the rate of change of heart rate depends on the difference between a target heart rate (<span class="math inline">\(HR_{target}\)</span>) and the current heart rate (<span class="math inline">\(HR\)</span>), the rate function might be <span class="math inline">\(k(HR_{target} - HR)\)</span>, as we saw earlier.</li>
</ul></li>
<li><p><strong>Combining Influences:</strong> The rate function can include multiple terms that represent different processes affecting the state variable. Terms with a positive sign typically indicate processes that increase the state variable, while terms with a negative sign indicate processes that decrease it. The net rate of change is the sum of these individual contributions.</p></li>
<li><p><strong>Dependence on State Variables and Parameters:</strong> The rate function almost always depends on one or more of the state variables in the model (often the state variable whose rate of change it describes, but also potentially other coupled state variables). It also always depends on one or more of the model’s parameters, which quantify the strength or speed of these influences.</p></li>
<li><p><strong>Nonlinearity:</strong> The rate function can be linear or nonlinear in terms of the state variables. Nonlinearities often arise from saturable processes, feedback loops, or interactions between multiple state variables. These nonlinearities can lead to complex and interesting dynamic behaviors.</p></li>
<li><p><strong>For Each State Variable:</strong> In a model with multiple state variables, there will be a separate ODE (and thus a separate rate function) for each state variable, describing its rate of change. These rate functions can be coupled, meaning the rate of change of one state variable can depend on the current values of other state variables in the system.</p></li>
</ul>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
R Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>When you define your ODE model in R for use with <code>deSolve</code>, you will create a function that takes the current time, the current values of the state variables, and the parameters as input, and returns a list containing the rates of change for each state variable. The rate functions are implemented within this R function.</p>
</div>
</div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Example: One state variable (C), one parameter (k)</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>model_function <span class="ot">&lt;-</span> <span class="cf">function</span>(t, state, parameters) {</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  C <span class="ot">&lt;-</span> state[<span class="dv">1</span>] <span class="co"># The state variable</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>  k <span class="ot">&lt;-</span> parameters[<span class="st">"k_clearance"</span>] <span class="co"># A parameter</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  dC_dt <span class="ot">&lt;-</span> <span class="sc">-</span>k <span class="sc">*</span> C <span class="co"># The rate function</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(dC_dt)) <span class="co"># Return the rate of change as a list</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Physiological Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>The rate function is where your understanding of the underlying physiology is most directly encoded. It’s where you translate your knowledge of how different factors (current levels of variables, inherent properties) influence the rate at which a physiological quantity changes. Building a good model often involves carefully thinking about and formulating these rate functions based on known biological mechanisms.</p>
</div>
</div>
</section>
<section id="putting-it-all-together-a-glucose-disappearance-model" class="level3" data-number="4.2.4">
<h3 data-number="4.2.4" class="anchored" data-anchor-id="putting-it-all-together-a-glucose-disappearance-model"><span class="header-section-number">4.2.4</span> Putting It All Together: A Glucose Disappearance Model</h3>
<p>Let’s consider a very simple model of glucose disappearance from the bloodstream after a bolus injection.</p>
<ul>
<li><strong>State Variable:</strong> Plasma glucose concentration, <span class="math inline">\(G(t)\)</span> (in mmol/L).</li>
<li><strong>Parameter:</strong> A first-order disappearance rate constant, <span class="math inline">\(k_{glucose}\)</span> (in <span class="math inline">\(min^{-1}\)</span>).</li>
</ul>
<p>We hypothesize that the rate at which glucose disappears from the blood is proportional to the current glucose concentration. This leads to the following ODE:</p>
<p><span class="math display">\[
\frac{dG}{dt} = -k_{glucose} \cdot G(t)
\]</span></p>
<p>Here:</p>
<ul>
<li><span class="math inline">\(G(t)\)</span> is our <strong>state variable</strong>.</li>
<li><span class="math inline">\(k_{glucose}\)</span> is our <strong>parameter</strong>, representing the overall rate of glucose removal per unit concentration.</li>
<li><span class="math inline">\(-k_{glucose} \cdot G(t)\)</span> is the <strong>rate function</strong>, describing how the rate of change of glucose concentration depends on the current glucose level and the parameter <span class="math inline">\(k_{glucose}\)</span>. The negative sign indicates that glucose is disappearing (decreasing).</li>
</ul>
<p>To simulate this model, we would also need an initial condition, say the glucose concentration immediately after the bolus injection, <span class="math inline">\(G(0) = G_0\)</span>. Solving this ODE (which, as we noted earlier, has an analytical solution <span class="math inline">\(G(t) = G_0 e^{-k_{glucose} t}\)</span>) would give us the predicted time course of glucose concentration in the blood.</p>
<p>In this section, we’ve dissected the three fundamental components of an ODE model:</p>
<ul>
<li><strong>State variables:</strong> The dynamic quantities we are tracking.</li>
<li><strong>Parameters:</strong> The constant properties that influence the dynamics.</li>
<li><strong>The rate function:</strong> The mathematical rule that determines how the state variables change over time.</li>
</ul>
<p>Understanding these components is the first crucial step in being able to both interpret and build ODE models of physiological systems. In the next section, we will build upon this knowledge and start to translate verbal descriptions of physiological processes into the language of these ODE models. We’ll see how to take a biological scenario and formulate the state variables, identify relevant parameters, and construct the rate functions that describe their interactions and dynamics. This will pave the way for us to bring these models to life using the power of R in the subsequent parts of this book.</p>
</section>
</section>
<section id="developing-simple-models-from-verbal-descriptions-of-physiological-processes" class="level2" data-number="4.3">
<h2 data-number="4.3" class="anchored" data-anchor-id="developing-simple-models-from-verbal-descriptions-of-physiological-processes"><span class="header-section-number">4.3</span> Developing simple models from verbal descriptions of physiological processes</h2>
<p>Now that we have a grasp of what ordinary differential equations are and the roles of their key components (state variables, parameters, and the rate function), the next crucial step is to learn how to translate our intuitive understanding of physiological processes, often expressed in words, into the precise language of ODEs. This is where the art and science of mathematical modeling in physiology truly begin.</p>
<p>The process typically involves breaking down a physiological phenomenon into its essential components and interactions, identifying what changes over time (our state variables), what influences these changes (leading to our rate functions), and what fixed properties govern the system (our parameters).</p>
<p>Let’s work through several examples, starting with simple scenarios and gradually increasing complexity, to illustrate this translation process.</p>
<section id="example-1-simple-substance-diffusion" class="level3" data-number="4.3.1">
<h3 data-number="4.3.1" class="anchored" data-anchor-id="example-1-simple-substance-diffusion"><span class="header-section-number">4.3.1</span> Example 1: Simple Substance Diffusion</h3>
<p>Imagine a substance moving across a permeable membrane separating two compartments. The rate of movement from compartment 1 to compartment 2 is proportional to the concentration difference between the two compartments.</p>
<p><strong>Modeling Steps:</strong></p>
<ol type="1">
<li><p><strong>Identify State Variables:</strong> What are the quantities changing over time? Here, it’s the concentration of the substance in each compartment. Let <span class="math inline">\(C_1(t)\)</span> be the concentration in compartment 1 and <span class="math inline">\(C_2(t)\)</span> be the concentration in compartment 2. These are our two state variables.</p></li>
<li><p><strong>Identify Parameters:</strong> What are the fixed properties influencing this process? The permeability of the membrane will determine the rate of diffusion. Let’s call this permeability constant <span class="math inline">\(P\)</span>. We might also need to consider the volumes of the two compartments, <span class="math inline">\(V_1\)</span> and <span class="math inline">\(V_2\)</span>, if we want to track the amount of substance rather than concentration, or if the volumes influence the concentration changes. For simplicity, let’s assume fixed volumes and focus on concentration.</p></li>
<li><p><strong>Formulate the Rate Functions:</strong> Now, let’s translate the verbal description into mathematical equations for the rates of change of our state variables.</p>
<ul>
<li><p>The rate of movement from compartment 1 to 2 is proportional to <span class="math inline">\((C_1 - C_2)\)</span>. Let the rate of <em>change of amount</em> in compartment 2 due to this movement be <span class="math inline">\(P \cdot (C_1 - C_2)\)</span>. To get the rate of change of <em>concentration</em> in compartment 2, we need to divide by the volume <span class="math inline">\(V_2\)</span>:</p>
<p><span class="math display">\[
  \frac{dC_2}{dt} = \frac{P}{V_2} (C_1 - C_2)
  \]</span></p>
<p>This term represents an increase in <span class="math inline">\(C_2\)</span>.</p></li>
<li><p>Similarly, the movement from 1 to 2 causes a decrease in the amount in compartment 1. Dividing by <span class="math inline">\(V_1\)</span> to get the rate of change of concentration in compartment 1:</p>
<p><span class="math display">\[
  \frac{dC_1}{dt} = -\frac{P}{V_1} (C_1 - C_2)
  \]</span></p>
<p>The negative sign indicates a decrease in <span class="math inline">\(C_1\)</span> due to diffusion to compartment 2.</p></li>
</ul>
<p>Our simple model of diffusion between two compartments is then a system of two coupled ODEs:</p>
<p><span class="math display">\[
\frac{dC_1}{dt} = -\frac{P}{V_1} (C_1 - C_2)\]</span><span class="math display">\[\frac{dC_2}{dt} = \frac{P}{V_2} (C_1 - C_2)
\]</span></p>
<p>Here, the rate of change of concentration in each compartment depends on the concentrations in both compartments and the parameters <span class="math inline">\(P\)</span>, <span class="math inline">\(V_1\)</span>, and <span class="math inline">\(V_2\)</span>.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Physiological Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>This simple model captures the fundamental principle of passive transport driven by concentration gradients, a crucial process in many physiological systems (e.g., gas exchange in the lungs, nutrient exchange across capillaries).</p>
</div>
</div>
</section>
<section id="example-2-a-hormone-secretion-and-degradation-model-revisited" class="level3" data-number="4.3.2">
<h3 data-number="4.3.2" class="anchored" data-anchor-id="example-2-a-hormone-secretion-and-degradation-model-revisited"><span class="header-section-number">4.3.2</span> Example 2: A Hormone Secretion and Degradation Model (Revisited)</h3>
<p>A hormone is secreted into the bloodstream at a constant rate. It is also degraded in the bloodstream at a rate proportional to its current concentration.</p>
<p><strong>Modeling Steps:</strong></p>
<ol type="1">
<li><p><strong>Identify State Variables:</strong> The concentration of the hormone in the bloodstream, <span class="math inline">\(H(t)\)</span>. (One state variable in this case).</p></li>
<li><p><strong>Identify Parameters:</strong></p>
<ul>
<li>Secretion rate, <span class="math inline">\(S\)</span> (e.g., in concentration units per time).</li>
<li>Degradation rate constant, <span class="math inline">\(k_{deg}\)</span> (per time).</li>
</ul></li>
<li><p><strong>Formulate the Rate Function:</strong> The rate of change of hormone concentration is the balance between secretion (which increases concentration) and degradation (which decreases it).</p>
<ul>
<li>Rate of increase due to secretion: <span class="math inline">\(S\)</span> (constant).</li>
<li>Rate of decrease due to degradation: <span class="math inline">\(k_{deg} \cdot H(t)\)</span> (proportional to concentration).</li>
</ul>
<p>Combining these gives us the ODE:</p>
<p><span class="math display">\[
\frac{dH}{dt} = S - k_{deg} H(t)
\]</span></p>
<p>This single first-order ODE describes the dynamics of the hormone concentration.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Physiological Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>Many hormones and signaling molecules have their levels regulated by a balance between production/release and degradation/clearance. This simple model captures this fundamental regulatory motif.</p>
</div>
</div>
</section>
<section id="example-3-a-simple-model-of-muscle-fatigue" class="level3" data-number="4.3.3">
<h3 data-number="4.3.3" class="anchored" data-anchor-id="example-3-a-simple-model-of-muscle-fatigue"><span class="header-section-number">4.3.3</span> Example 3: A Simple Model of Muscle Fatigue</h3>
<p>During sustained muscle activity, a fatigue factor builds up. The rate of buildup of this fatigue factor is proportional to the level of muscle activity. The muscle’s force-generating capacity decreases linearly with the level of the fatigue factor. When activity ceases, the fatigue factor decays exponentially back to zero.</p>
<p><strong>Modeling Steps:</strong></p>
<ol type="1">
<li><p><strong>Identify State Variables:</strong> We need a variable to represent the fatigue factor, let’s call it <span class="math inline">\(F(t)\)</span>, and perhaps a measure of muscle activity, <span class="math inline">\(A(t)\)</span>. Let’s assume <span class="math inline">\(A(t)\)</span> is an input to our model (we prescribe it, e.g., it’s high during exercise and zero at rest), and <span class="math inline">\(F(t)\)</span> is our state variable that changes over time. We might also consider muscle force as a state variable, but the description suggests it’s directly related to <span class="math inline">\(F(t)\)</span>. So, let’s focus on <span class="math inline">\(F(t)\)</span> as the primary dynamic state.</p></li>
<li><p><strong>Identify Parameters:</strong></p>
<ul>
<li>Rate constant for fatigue buildup per unit activity, <span class="math inline">\(k_{buildup}\)</span>.</li>
<li>Rate constant for fatigue decay, <span class="math inline">\(k_{decay}\)</span>.</li>
<li>A parameter relating fatigue to force reduction, say <span class="math inline">\(\alpha\)</span> (so force <span class="math inline">\(\propto 1 - \alpha F\)</span>).</li>
</ul></li>
<li><p><strong>Formulate the Rate Function for Fatigue (<span class="math inline">\(F(t)\)</span>):</strong></p>
<ul>
<li><p>During muscle activity (<span class="math inline">\(A(t) &gt; 0\)</span>): The rate of buildup is proportional to <span class="math inline">\(A(t)\)</span>: <span class="math display">\[\frac{dF}{dt} = k_{buildup} \cdot A(t) - k_{decay} \cdot F(t)\]</span> We’ve also included a decay term here, assuming some natural recovery even during activity.</p></li>
<li><p>When activity ceases (<span class="math inline">\(A(t) = 0\)</span>): The fatigue factor decays exponentially: <span class="math display">\[\frac{dF}{dt} = -k_{decay} \cdot F(t)\]</span></p></li>
</ul>
<p>This example shows how the rate function can depend on external inputs (<span class="math inline">\(A(t)\)</span>) and can change depending on the conditions. This might require us to define our model in a way that accounts for these different phases (activity vs.&nbsp;rest).</p>
<p>We could also model muscle force (<span class="math inline">\(Force(t)\)</span>) as being related to the fatigue factor:</p>
<p><span class="math display">\[
Force(t) = Force_{max} \cdot (1 - \alpha F(t))
\]</span></p>
<p>Here, <span class="math inline">\(Force(t)\)</span> is not a state variable whose rate of change is directly modeled by an ODE, but rather an output that depends on the state variable <span class="math inline">\(F(t)\)</span>.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Physiological Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>This model, although simple, captures the common experience of fatigue building up during exertion and recovering afterward. More sophisticated models of fatigue might include multiple state variables representing different metabolic factors.</p>
</div>
</div>
<p><strong>General Strategies for Translating Verbal Descriptions to ODEs:</strong></p>
<ol type="1">
<li><strong>Identify the “things” that are changing:</strong> These will be your state variables.</li>
<li><strong>Determine what causes these “things” to increase or decrease:</strong> These will inform the terms in your rate functions. Think about rates of flow, production, consumption, conversion, etc.</li>
<li><strong>Identify any constant factors that influence these rates:</strong> These will be your parameters.</li>
<li><strong>Express the relationships mathematically:</strong> If a rate is proportional to a quantity <span class="math inline">\(X\)</span>, it will involve a term like <span class="math inline">\(k \cdot X\)</span>. If it’s a constant rate, it will be just a parameter. If it depends on the difference between two quantities, it will involve a term like <span class="math inline">\(k \cdot (Y - Z)\)</span>.</li>
</ol>
<p><strong>Dealing with Multiple Processes:</strong></p>
<p>Often, the rate of change of a state variable is influenced by multiple processes acting simultaneously. In this case, the rate function is the sum of the rates of all these individual processes (with appropriate signs for increases and decreases).</p>
<p>For a state variable <span class="math inline">\(X\)</span>, if it increases due to process 1 at rate <span class="math inline">\(R_1\)</span> and decreases due to process 2 at rate <span class="math inline">\(R_2\)</span>, the ODE would be:</p>
<p><span class="math display">\[
\frac{dX}{dt} = R_1 - R_2
\]</span></p>
</section>
<section id="example-blood-glucose-regulation-simplified" class="level3" data-number="4.3.4">
<h3 data-number="4.3.4" class="anchored" data-anchor-id="example-blood-glucose-regulation-simplified"><span class="header-section-number">4.3.4</span> Example: Blood Glucose Regulation (Simplified)</h3>
<p>Blood glucose concentration increases due to glucose entering the bloodstream from the gut (at a rate that decreases as glucose levels rise) and decreases due to uptake by tissues (at a rate proportional to glucose concentration).</p>
<p><strong>Modeling Steps:</strong></p>
<ol type="1">
<li><p><strong>State Variable:</strong> Blood glucose concentration, <span class="math inline">\(G(t)\)</span>.</p></li>
<li><p><strong>Parameters:</strong></p>
<ul>
<li>Maximum rate of glucose entry from the gut, <span class="math inline">\(V_{in}\)</span>.</li>
<li>A parameter controlling how glucose entry decreases with <span class="math inline">\(G\)</span>, <span class="math inline">\(K_{in}\)</span>.</li>
<li>Rate constant for glucose uptake by tissues, <span class="math inline">\(k_{out}\)</span>.</li>
</ul></li>
<li><p><strong>Rate Function:</strong></p>
<ul>
<li>Rate of glucose entry: Let’s model the decreasing rate with a form like <span class="math inline">\(\frac{V_{in}}{1 + G(t)/K_{in}}\)</span>. This decreases as <span class="math inline">\(G(t)\)</span> increases (a form of saturable input).</li>
<li>Rate of glucose uptake: <span class="math inline">\(k_{out} \cdot G(t)\)</span> (proportional to glucose).</li>
</ul>
<p>Combining these, the ODE for blood glucose concentration would be:</p>
<p><span class="math display">\[
\frac{dG}{dt} = \frac{V_{in}}{1 + G(t)/K_{in}} - k_{out} G(t)
\]</span></p>
<p>This single ODE captures a basic regulatory aspect: as glucose levels rise, the input might slow down, while the output increases.</p></li>
</ol>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Physiological Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>Even this simplified model hints at the feedback mechanisms involved in glucose regulation. More complex models would include the role of insulin and other hormones.</p>
</div>
</div>
</section>
<section id="the-importance-of-assumptions" class="level3" data-number="4.3.5">
<h3 data-number="4.3.5" class="anchored" data-anchor-id="the-importance-of-assumptions"><span class="header-section-number">4.3.5</span> The Importance of Assumptions</h3>
<p>It’s crucial to recognize that any mathematical model is based on a set of simplifying assumptions about the real physiological system. The level of detail we include depends on the specific questions we want to address with the model. Simple models, like the ones we’ve discussed, can be useful for understanding fundamental principles, while more complex models might be needed for detailed quantitative predictions.</p>
<p>As we move forward, we will encounter more sophisticated ways of formulating rate functions to represent various physiological phenomena, including nonlinearities, feedback loops, and interactions between multiple state variables. The key is to start with a clear understanding of the verbal description of the process and then systematically translate the components and their interactions into the mathematical language of ODEs.</p>
<p>In the next section, we will explore some basic examples of ODE models relevant to exercise physiology and cardiac autonomic modulation, further solidifying this translation process. We will then be well-equipped to start implementing and simulating these models using R in Part 2.</p>
<p>Okay, let’s craft a significantly longer version of the “Examples” subsection, providing more depth and potentially introducing nuances within the basic models to illustrate the concepts more thoroughly and approach the desired length.</p>
</section>
</section>
<section id="examples-from-basic-to-complex-models" class="level2" data-number="4.4">
<h2 data-number="4.4" class="anchored" data-anchor-id="examples-from-basic-to-complex-models"><span class="header-section-number">4.4</span> Examples: From basic to complex models</h2>
<p>To truly grasp the power and flexibility of ODE modeling, it’s essential to see how even seemingly simple physiological scenarios can be translated into mathematical equations. This subsection will delve into two fundamental examples: a model of substance concentration change and a model of muscle fatigue. We will explore variations and expansions of these basic models to highlight how different assumptions about the underlying biology lead to different mathematical formulations and, consequently, different predicted dynamic behaviors.</p>
<section id="example-1-a-comprehensive-exploration-of-substance-concentration-change" class="level3" data-number="4.4.1">
<h3 data-number="4.4.1" class="anchored" data-anchor-id="example-1-a-comprehensive-exploration-of-substance-concentration-change"><span class="header-section-number">4.4.1</span> Example 1: A Comprehensive Exploration of Substance Concentration Change</h3>
<p>Let’s consider a substance within a well-defined physiological compartment, such as a hormone in the bloodstream or a metabolite within a cell. The concentration of this substance, which we denote as <span class="math inline">\(C(t)\)</span>, is our state variable. Its dynamics will be governed by processes that add to its concentration (production, influx) and processes that remove it (degradation, efflux).</p>
<p><strong>Scenario 1.1: Simple Production and First-Order Degradation</strong></p>
<p>The substance is produced at a constant rate, <span class="math inline">\(P\)</span>, and is degraded at a rate proportional to its current concentration, with a rate constant <span class="math inline">\(k_{deg}\)</span>.</p>
<p><strong>ODE Model:</strong></p>
<p><span class="math display">\[
\frac{dC}{dt} = P - k_{deg} \cdot C(t)
\]</span></p>
<p>Here, <span class="math inline">\(P\)</span> has units of concentration per time (e.g., mol/(L·min)), and <span class="math inline">\(k_{deg}\)</span> has units of inverse time (e.g., <span class="math inline">\(min^{-1}\)</span>). The term <span class="math inline">\(k_{deg} \cdot C(t)\)</span> thus represents the rate of concentration decrease due to degradation, with the same units as production.</p>
<p>As we discussed earlier, this model leads to an exponential approach to a steady-state concentration <span class="math inline">\(C_{ss} = P/k_{deg}\)</span>. The time it takes to reach this steady state is related to <span class="math inline">\(1/k_{deg}\)</span>.</p>
<p><strong>Scenario 1.2: Production Dependent on Another Substance</strong></p>
<p>Now, imagine the production of our substance <span class="math inline">\(C\)</span> is not constant but is stimulated by the concentration of another substance <span class="math inline">\(S(t)\)</span>. Let’s assume this stimulation follows a simple linear relationship: the rate of production of <span class="math inline">\(C\)</span> is <span class="math inline">\(k_{prod} \cdot S(t)\)</span>, where <span class="math inline">\(k_{prod}\)</span> is a constant. Substance <span class="math inline">\(C\)</span> still degrades at a first-order rate.</p>
<p><strong>ODE Model:</strong></p>
<p><span class="math display">\[
\frac{dC}{dt} = k_{prod} \cdot S(t) - k_{deg} \cdot C(t)
\]</span></p>
<p>Here, the dynamics of <span class="math inline">\(C(t)\)</span> now depend on the temporal profile of <span class="math inline">\(S(t)\)</span>. If <span class="math inline">\(S(t)\)</span> itself is governed by another ODE, we would have a coupled system. For instance, if <span class="math inline">\(S(t)\)</span> increases linearly with time (<span class="math inline">\(S(t) = \alpha t\)</span>), then the rate of production of <span class="math inline">\(C\)</span> would also increase linearly.</p>
<p><strong>Scenario 1.3: Saturable Degradation</strong></p>
<p>Instead of a degradation rate strictly proportional to concentration, many biological processes exhibit saturation. At high concentrations, the degradation machinery might become overwhelmed, and the rate of degradation plateaus. We can model this using Michaelis-Menten kinetics.</p>
<p><strong>ODE Model:</strong></p>
<p><span class="math display">\[
\frac{dC}{dt} = P - \frac{V_{max} \cdot C(t)}{K_m + C(t)}
\]</span></p>
<p>Here, <span class="math inline">\(P\)</span> is the constant production rate, <span class="math inline">\(V_{max}\)</span> is the maximum degradation rate (in concentration per time), and <span class="math inline">\(K_m\)</span> is the Michaelis constant (in concentration), representing the concentration at which the degradation rate is half of <span class="math inline">\(V_{max}\)</span>. This model is nonlinear, which can lead to more complex dynamic behaviors, including non-exponential approaches to steady state and the possibility of multiple steady states under certain conditions (though not in this simple form with constant production).</p>
<p><strong>Scenario 1.4: Influx and Efflux Across a Membrane</strong></p>
<p>Consider the concentration of a substance inside a cell. It can enter the cell from the extracellular space at a rate proportional to the extracellular concentration (<span class="math inline">\(C_{out}\)</span>, assumed constant) and leave the cell at a rate proportional to its intracellular concentration (<span class="math inline">\(C_{in} = C(t)\)</span>).</p>
<p><strong>ODE Model:</strong></p>
<p><span class="math display">\[
\frac{dC_{in}}{dt} = k_{in} \cdot C_{out} - k_{out} \cdot C_{in}(t)
\]</span></p>
<p>Here, <span class="math inline">\(k_{in}\)</span> and <span class="math inline">\(k_{out}\)</span> are permeability coefficients (with units of inverse time if <span class="math inline">\(C_{out}\)</span> and <span class="math inline">\(C_{in}\)</span> are concentrations, leading to rates of change in concentration per time). This model again has the form of a first-order linear ODE, leading to an exponential approach to a steady state where the rates of influx and efflux are equal.</p>
</section>
<section id="example-2-a-multifaceted-model-of-muscle-fatigue" class="level3" data-number="4.4.2">
<h3 data-number="4.4.2" class="anchored" data-anchor-id="example-2-a-multifaceted-model-of-muscle-fatigue"><span class="header-section-number">4.4.2</span> Example 2: A Multifaceted Model of Muscle Fatigue</h3>
<p>Muscle fatigue is a complex phenomenon with contributions from various factors, including metabolite accumulation, energy depletion, and neural signaling. Let’s build a simple ODE model focusing on a key aspect: the accumulation and recovery of a fatigue-inducing metabolite.</p>
<p><strong>Scenario 2.1: Basic Accumulation and Linear Clearance</strong></p>
<p>During muscle activity at a constant level <span class="math inline">\(A\)</span>, a metabolite <span class="math inline">\(M(t)\)</span> accumulates at a rate proportional to <span class="math inline">\(A\)</span>. The metabolite is cleared at a rate proportional to its current concentration.</p>
<p><strong>ODE Model:</strong></p>
<p><span class="math display">\[
\frac{dM}{dt} = k_{prod} \cdot A - k_{clear} \cdot M(t)
\]</span></p>
<p>We analyzed this model earlier. It leads to a steady-state metabolite level where production equals clearance.</p>
<p><strong>Scenario 2.2: Activity-Dependent Production and Enhanced Recovery</strong></p>
<p>Let’s refine this. The rate of metabolite production is indeed proportional to the level of muscle activity <span class="math inline">\(A(t)\)</span>, which can now vary over time (e.g., during an exercise bout followed by rest). The clearance of the metabolite is proportional to its concentration, but we hypothesize that during recovery (when <span class="math inline">\(A(t) = 0\)</span>), the clearance mechanism is more efficient.</p>
<p><strong>ODE Model:</strong></p>
<p>We can express this piecewise:</p>
<p>If <span class="math inline">\(A(t) &gt; 0\)</span> (exercise):</p>
<p><span class="math display">\[
\frac{dM}{dt} = k_{prod} \cdot A(t) - k_{clear\_ex} \cdot M(t)
\]</span></p>
<p>If <span class="math inline">\(A(t) = 0\)</span> (recovery):</p>
<p><span class="math display">\[
\frac{dM}{dt} = -k_{clear\_rec} \cdot M(t)
\]</span></p>
<p>where <span class="math inline">\(k_{clear\_rec} &gt; k_{clear\_ex}\)</span>.</p>
<p>This model allows us to simulate the rise of the metabolite during exercise (possibly with varying intensity <span class="math inline">\(A(t)\)</span>) and its faster decline during the recovery phase.</p>
<p><strong>Scenario 2.3: Threshold Effect on Force Production</strong></p>
<p>Let’s link the metabolite concentration to muscle force (<span class="math inline">\(F\)</span>). Suppose that force production is negatively affected by the metabolite concentration, but only above a certain threshold (<span class="math inline">\(M_{thresh}\)</span>). Above this threshold, force decreases linearly with increasing metabolite concentration.</p>
<p><strong>Algebraic Equation (not an ODE for force, but links to our state variable):</strong></p>
<p><span class="math display">\[
F(t) =
\begin{cases}
  F_{max}                               &amp; \text{if } M(t) \leq M_{thresh} \\
  F_{max} - s \cdot (M(t) - M_{thresh}) &amp; \text{if } M(t) &gt; M_{thresh}
\end{cases}
\]</span></p>
<p>Here, <span class="math inline">\(F_{max}\)</span> is the maximal force, and <span class="math inline">\(s\)</span> is a sensitivity parameter. By combining this algebraic equation with the ODE for <span class="math inline">\(M(t)\)</span> from Scenario 2.2, we can model how muscle force might change dynamically during exercise and recovery as a consequence of metabolite accumulation.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Physiological Insight
</div>
</div>
<div class="callout-body-container callout-body">
<p>In reality, muscle fatigue is likely due to the interplay of multiple factors. We could extend our model to include another fatigue-related variable, say <span class="math inline">\(E(t)\)</span> representing energy depletion, which also affects force production and whose dynamics depend on muscle activity and recovery processes. This would lead to a system of coupled ODEs for <span class="math inline">\(M(t)\)</span> and <span class="math inline">\(E(t)\)</span>, and then an algebraic equation relating both to force <span class="math inline">\(F(t)\)</span>. This moves us towards more complex, multi-state variable models.</p>
</div>
</div>
<p>By exploring these different scenarios for both substance concentration change and muscle fatigue, you can see how the verbal description of a physiological process directly translates into the components of an ODE model: the state variable(s), the parameters that quantify the rates of change, and the rate function(s) that describe how these changes occur. The complexity of the model depends on the level of detail we want to include about the underlying mechanisms.</p>
<p>In the following chapters, we will take these types of simple models and learn how to bring them to life using the computational power of R, allowing us to simulate their behavior and visualize the resulting dynamics. This will provide you with the tools to explore your own hypotheses about physiological systems using the language of ordinary differential equations.</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./03-thinking_dynamically_rates_of_change.html" class="pagination-link" aria-label="Thinking Dynamically: Rates of Change">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Thinking Dynamically: Rates of Change</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./05-introduction_to_the_desolve_package.html" class="pagination-link" aria-label="Introduction to the `deSolve` Package">
        <span class="nav-page-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to the <code>deSolve</code> Package</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Made with <i class="fa-solid fa-heart" style="color: #ff0000;"></i> by Matías Castillo-Aguilar</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/matcasti/The-Physiological-Blueprint-Book/edit/main/04-building_simple_differential_equation_models.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/matcasti/The-Physiological-Blueprint-Book/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/matcasti">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://bayesically-speaking.com/">
      <i class="bi bi-globe" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://orcid.org/0000-0001-7291-247X">
<p><i class="fa-brands fa-orcid" aria-label="orcid"></i></p>
</a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>