<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.29">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>1&nbsp; Why Model Physiology? – The Physiological Blueprint</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./02-a_gentle_introduction_to_r_for_modelers.html" rel="next">
<link href="./preface.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js" type="module"></script>
<script src="site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-0815c480559380816a4d1ea211a47e91.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark-748b535e376f14d4692bf2b2e5fd6380.css" rel="stylesheet" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-0815c480559380816a4d1ea211a47e91.css" rel="stylesheet" class="quarto-color-scheme-extra" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-485d01fc63b59abcd3ee1bf1e8e2748d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark-7a339148c3b2635d23d0fec43941109e.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<link href="site_libs/bootstrap/bootstrap-485d01fc63b59abcd3ee1bf1e8e2748d.min.css" rel="stylesheet" append-hash="true" class="quarto-color-scheme-extra" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/quarto-contrib/fontawesome6-1.2.0/all.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/fontawesome6-1.2.0/latex-fontsize.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating quarto-light"><script id="quarto-html-before-body" type="application/javascript">
    const toggleBodyColorMode = (bsSheetEl) => {
      const mode = bsSheetEl.getAttribute("data-mode");
      const bodyEl = window.document.querySelector("body");
      if (mode === "dark") {
        bodyEl.classList.add("quarto-dark");
        bodyEl.classList.remove("quarto-light");
      } else {
        bodyEl.classList.add("quarto-light");
        bodyEl.classList.remove("quarto-dark");
      }
    }
    const toggleBodyColorPrimary = () => {
      const bsSheetEl = window.document.querySelector("link#quarto-bootstrap:not([rel=disabled-stylesheet])");
      if (bsSheetEl) {
        toggleBodyColorMode(bsSheetEl);
      }
    }
    const setColorSchemeToggle = (alternate) => {
      const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
      for (let i=0; i < toggles.length; i++) {
        const toggle = toggles[i];
        if (toggle) {
          if (alternate) {
            toggle.classList.add("alternate");
          } else {
            toggle.classList.remove("alternate");
          }
        }
      }
    };
    const toggleColorMode = (alternate) => {
      // Switch the stylesheets
      const primaryStylesheets = window.document.querySelectorAll('link.quarto-color-scheme:not(.quarto-color-alternate)');
      const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
      manageTransitions('#quarto-margin-sidebar .nav-link', false);
      if (alternate) {
        // note: dark is layered on light, we don't disable primary!
        enableStylesheet(alternateStylesheets);
        for (const sheetNode of alternateStylesheets) {
          if (sheetNode.id === "quarto-bootstrap") {
            toggleBodyColorMode(sheetNode);
          }
        }
      } else {
        disableStylesheet(alternateStylesheets);
        enableStylesheet(primaryStylesheets)
        toggleBodyColorPrimary();
      }
      manageTransitions('#quarto-margin-sidebar .nav-link', true);
      // Switch the toggles
      setColorSchemeToggle(alternate)
      // Hack to workaround the fact that safari doesn't
      // properly recolor the scrollbar when toggling (#1455)
      if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
        manageTransitions("body", false);
        window.scrollTo(0, 1);
        setTimeout(() => {
          window.scrollTo(0, 0);
          manageTransitions("body", true);
        }, 40);
      }
    }
    const disableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        stylesheet.rel = 'disabled-stylesheet';
      }
    }
    const enableStylesheet = (stylesheets) => {
      for (let i=0; i < stylesheets.length; i++) {
        const stylesheet = stylesheets[i];
        if(stylesheet.rel !== 'stylesheet') { // for Chrome, which will still FOUC without this check
          stylesheet.rel = 'stylesheet';
        }
      }
    }
    const manageTransitions = (selector, allowTransitions) => {
      const els = window.document.querySelectorAll(selector);
      for (let i=0; i < els.length; i++) {
        const el = els[i];
        if (allowTransitions) {
          el.classList.remove('notransition');
        } else {
          el.classList.add('notransition');
        }
      }
    }
    const isFileUrl = () => {
      return window.location.protocol === 'file:';
    }
    const hasAlternateSentinel = () => {
      let styleSentinel = getColorSchemeSentinel();
      if (styleSentinel !== null) {
        return styleSentinel === "alternate";
      } else {
        return false;
      }
    }
    const setStyleSentinel = (alternate) => {
      const value = alternate ? "alternate" : "default";
      if (!isFileUrl()) {
        window.localStorage.setItem("quarto-color-scheme", value);
      } else {
        localAlternateSentinel = value;
      }
    }
    const getColorSchemeSentinel = () => {
      if (!isFileUrl()) {
        const storageValue = window.localStorage.getItem("quarto-color-scheme");
        return storageValue != null ? storageValue : localAlternateSentinel;
      } else {
        return localAlternateSentinel;
      }
    }
    const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
      const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
      const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
      let newTheme = '';
      if(authorPrefersDark) {
        newTheme = isAlternate ? baseTheme : alternateTheme;
      } else {
        newTheme = isAlternate ? alternateTheme : baseTheme;
      }
      const changeGiscusTheme = () => {
        // From: https://github.com/giscus/giscus/issues/336
        const sendMessage = (message) => {
          const iframe = document.querySelector('iframe.giscus-frame');
          if (!iframe) return;
          iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
        }
        sendMessage({
          setConfig: {
            theme: newTheme
          }
        });
      }
      const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
      if (isGiscussLoaded) {
        changeGiscusTheme();
      }
    };
    const authorPrefersDark = false;
    const darkModeDefault = authorPrefersDark;
      document.querySelector('link#quarto-text-highlighting-styles.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
      document.querySelector('link#quarto-bootstrap.quarto-color-scheme-extra').rel = 'disabled-stylesheet';
    let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
    // Dark / light mode switch
    window.quartoToggleColorScheme = () => {
      // Read the current dark / light value
      let toAlternate = !hasAlternateSentinel();
      toggleColorMode(toAlternate);
      setStyleSentinel(toAlternate);
      toggleGiscusIfUsed(toAlternate, darkModeDefault);
    };
    // Switch to dark mode if need be
    if (hasAlternateSentinel()) {
      toggleColorMode(true);
    } else {
      toggleColorMode(false);
    }
  </script>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-why-model-physiology.html">Foundations in Modeling and R</a></li><li class="breadcrumb-item"><a href="./01-why-model-physiology.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Why Model Physiology?</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="quarto-sidebar-header"><div class="sidebar-header-item">
<p>This book is currently under development</p>
</div></div>
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">The Physiological Blueprint<br><small>Modeling Biological Systems with Ordinary Differential Equations in R</small><br></a> 
        <div class="sidebar-tools-main tools-wide">
    <a href="https://github.com/matcasti/The-Physiological-Blueprint-Book" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
    <div class="dropdown">
      <a href="" title="Download" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Download"><i class="bi bi-download"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./The-Physiological-Blueprint.pdf">
              <i class="bi bi-file-pdf pe-1"></i>
            Download PDF
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="./The-Physiological-Blueprint.epub">
              <i class="bi bi-journal pe-1"></i>
            Download ePub
            </a>
          </li>
      </ul>
    </div>
    <div class="dropdown">
      <a href="" title="Share" id="quarto-navigation-tool-dropdown-1" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" role="link" aria-label="Share"><i class="bi bi-share"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-1">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://twitter.com/intent/tweet?url=|url|">
              <i class="bi bi-twitter pe-1"></i>
            Twitter
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.facebook.com/sharer/sharer.php?u=|url|">
              <i class="bi bi-facebook pe-1"></i>
            Facebook
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://www.linkedin.com/sharing/share-offsite/?url=|url|">
              <i class="bi bi-linkedin pe-1"></i>
            LinkedIn
            </a>
          </li>
      </ul>
    </div>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Welcome</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dedication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Dedication</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preface.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Foundations in Modeling and R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./01-why-model-physiology.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Why Model Physiology?</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-a_gentle_introduction_to_r_for_modelers.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">A Gentle Introduction to R for Modelers</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-thinking_dynamically_rates_of_change.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Thinking Dynamically: Rates of Change</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-building_simple_differential_equation_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Building Simple Differential Equation Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Solving, Simulating, and Visualizing ODEs in R</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-introduction_to_the_desolve_package.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Introduction to the <code>deSolve</code> Package</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./06-numerical_methods_for_solving_odes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Numerical Methods for Solving ODEs</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./07-visualizing_model_dynamics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Visualizing Model Dynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./08-exploring_parameter_sensitivity_and_uncertainty.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Exploring Parameter Sensitivity and Uncertainty</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true">
 <span class="menu-text">Modeling Specific Physiological Systems</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./09-modeling_basic_cardiovascular_dynamics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Modeling Basic Cardiovascular Dynamics</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./10-introducing_autonomic_control_into_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Introducing Autonomic Control into Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-modeling_exercise_responses.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">Modeling Exercise Responses</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./12-focusing_on_cardiac_autonomic_modulation_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">Focusing on Cardiac Autonomic Modulation Models</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true">
 <span class="menu-text">Advanced Concepts and Future Directions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./13-building_more_complex_models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">Building More Complex Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./14-linking_models_to_data.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">Linking Models to Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./15-limitations_and_future_directions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">Limitations and Future Directions</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true">
 <span class="menu-text">Appendices</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix_a_r_installation_guide.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">A</span>&nbsp; <span class="chapter-title">R Installation Guide</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix_b_glossary_of_mathematical_and_physiological_terms.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">B</span>&nbsp; <span class="chapter-title">Glossary of Mathematical and Physiological Terms</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix_c_solutions_or_hints_to_select_exercises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">C</span>&nbsp; <span class="chapter-title">Solutions or Hints to Select Exercises</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./appendix_d_r_code_snippets_and_examples.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">D</span>&nbsp; <span class="chapter-title">R Code Snippets and Examples</span></span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#the-power-of-mathematical-modeling-in-biological-systems" id="toc-the-power-of-mathematical-modeling-in-biological-systems" class="nav-link active" data-scroll-target="#the-power-of-mathematical-modeling-in-biological-systems"><span class="header-section-number">1.1</span> The Power of Mathematical Modeling in Biological Systems</a>
  <ul class="collapse">
  <li><a href="#beyond-the-spreadsheet-the-living-system" id="toc-beyond-the-spreadsheet-the-living-system" class="nav-link" data-scroll-target="#beyond-the-spreadsheet-the-living-system"><span class="header-section-number">1.1.1</span> Beyond the Spreadsheet: The Living System</a></li>
  <li><a href="#the-power-of-simplification-the-map-and-the-territory" id="toc-the-power-of-simplification-the-map-and-the-territory" class="nav-link" data-scroll-target="#the-power-of-simplification-the-map-and-the-territory"><span class="header-section-number">1.1.2</span> The Power of Simplification (The Map and the Territory)</a></li>
  <li><a href="#seeing-the-unseen-emergent-properties" id="toc-seeing-the-unseen-emergent-properties" class="nav-link" data-scroll-target="#seeing-the-unseen-emergent-properties"><span class="header-section-number">1.1.3</span> Seeing the Unseen: Emergent Properties</a></li>
  <li><a href="#why-this-book-and-why-now" id="toc-why-this-book-and-why-now" class="nav-link" data-scroll-target="#why-this-book-and-why-now"><span class="header-section-number">1.1.4</span> Why This Book, and Why Now?</a></li>
  <li><a href="#the-path-ahead" id="toc-the-path-ahead" class="nav-link" data-scroll-target="#the-path-ahead"><span class="header-section-number">1.1.5</span> The Path Ahead</a></li>
  </ul></li>
  <li><a href="#the-role-of-models-in-hypothesis-generation-and-testing" id="toc-the-role-of-models-in-hypothesis-generation-and-testing" class="nav-link" data-scroll-target="#the-role-of-models-in-hypothesis-generation-and-testing"><span class="header-section-number">1.2</span> The Role of Models in Hypothesis Generation and Testing</a>
  <ul class="collapse">
  <li><a href="#the-what-if-machine-generating-new-ideas" id="toc-the-what-if-machine-generating-new-ideas" class="nav-link" data-scroll-target="#the-what-if-machine-generating-new-ideas"><span class="header-section-number">1.2.1</span> The “What-If” Machine: Generating New Ideas</a></li>
  <li><a href="#the-in-silico-laboratory-testing-without-the-treadmill" id="toc-the-in-silico-laboratory-testing-without-the-treadmill" class="nav-link" data-scroll-target="#the-in-silico-laboratory-testing-without-the-treadmill"><span class="header-section-number">1.2.2</span> The In Silico Laboratory: Testing without the Treadmill</a></li>
  <li><a href="#falsifiability-and-the-wrong-model" id="toc-falsifiability-and-the-wrong-model" class="nav-link" data-scroll-target="#falsifiability-and-the-wrong-model"><span class="header-section-number">1.2.3</span> Falsifiability and the “Wrong” Model</a></li>
  <li><a href="#case-in-point-autonomic-modulation" id="toc-case-in-point-autonomic-modulation" class="nav-link" data-scroll-target="#case-in-point-autonomic-modulation"><span class="header-section-number">1.2.4</span> Case in Point: Autonomic Modulation</a></li>
  </ul></li>
  <li><a href="#why-differential-equations-are-a-natural-language-for-physiology" id="toc-why-differential-equations-are-a-natural-language-for-physiology" class="nav-link" data-scroll-target="#why-differential-equations-are-a-natural-language-for-physiology"><span class="header-section-number">1.3</span> Why Differential Equations are a Natural Language for Physiology</a>
  <ul class="collapse">
  <li><a href="#the-speedometer-of-the-soul" id="toc-the-speedometer-of-the-soul" class="nav-link" data-scroll-target="#the-speedometer-of-the-soul"><span class="header-section-number">1.3.1</span> The Speedometer of the Soul</a></li>
  <li><a href="#the-logic-of-the-feedback-loop" id="toc-the-logic-of-the-feedback-loop" class="nav-link" data-scroll-target="#the-logic-of-the-feedback-loop"><span class="header-section-number">1.3.2</span> The Logic of the Feedback Loop</a></li>
  <li><a href="#the-ghost-in-the-differential" id="toc-the-ghost-in-the-differential" class="nav-link" data-scroll-target="#the-ghost-in-the-differential"><span class="header-section-number">1.3.3</span> The “Ghost” in the Differential</a></li>
  <li><a href="#continuity-in-a-discrete-world" id="toc-continuity-in-a-discrete-world" class="nav-link" data-scroll-target="#continuity-in-a-discrete-world"><span class="header-section-number">1.3.4</span> Continuity in a Discrete World</a></li>
  <li><a href="#embracing-the-complexity" id="toc-embracing-the-complexity" class="nav-link" data-scroll-target="#embracing-the-complexity"><span class="header-section-number">1.3.5</span> Embracing the Complexity</a></li>
  </ul></li>
  <li><a href="#examples-of-classic-physiological-models" id="toc-examples-of-classic-physiological-models" class="nav-link" data-scroll-target="#examples-of-classic-physiological-models"><span class="header-section-number">1.4</span> Examples of Classic Physiological Models</a>
  <ul class="collapse">
  <li><a href="#the-simplest-blueprint-exponential-growth-and-decay" id="toc-the-simplest-blueprint-exponential-growth-and-decay" class="nav-link" data-scroll-target="#the-simplest-blueprint-exponential-growth-and-decay"><span class="header-section-number">1.4.1</span> The Simplest Blueprint: Exponential Growth and Decay</a></li>
  <li><a href="#the-coffee-model-pharmacokinetics-and-drug-clearance" id="toc-the-coffee-model-pharmacokinetics-and-drug-clearance" class="nav-link" data-scroll-target="#the-coffee-model-pharmacokinetics-and-drug-clearance"><span class="header-section-number">1.4.2</span> The “Coffee” Model: Pharmacokinetics and Drug Clearance</a></li>
  <li><a href="#predator-and-prey-a-metaphor-for-autonomic-balance" id="toc-predator-and-prey-a-metaphor-for-autonomic-balance" class="nav-link" data-scroll-target="#predator-and-prey-a-metaphor-for-autonomic-balance"><span class="header-section-number">1.4.3</span> Predator and Prey: A Metaphor for Autonomic Balance</a></li>
  <li><a href="#the-hodgkin-huxley-model-the-ghost-in-the-nerve" id="toc-the-hodgkin-huxley-model-the-ghost-in-the-nerve" class="nav-link" data-scroll-target="#the-hodgkin-huxley-model-the-ghost-in-the-nerve"><span class="header-section-number">1.4.4</span> The Hodgkin-Huxley Model: The Ghost in the Nerve</a></li>
  </ul></li>
  <li><a href="#the-importance-of-computational-tools-like-r-for-solving-and-visualizing-models" id="toc-the-importance-of-computational-tools-like-r-for-solving-and-visualizing-models" class="nav-link" data-scroll-target="#the-importance-of-computational-tools-like-r-for-solving-and-visualizing-models"><span class="header-section-number">1.5</span> The Importance of Computational Tools (Like R) for Solving and Visualizing Models</a>
  <ul class="collapse">
  <li><a href="#the-blackboard-barrier-why-we-cant-do-it-alone" id="toc-the-blackboard-barrier-why-we-cant-do-it-alone" class="nav-link" data-scroll-target="#the-blackboard-barrier-why-we-cant-do-it-alone"><span class="header-section-number">1.5.1</span> The Blackboard Barrier: Why We Can’t Do It Alone</a></li>
  <li><a href="#why-r-is-our-chosen-lens" id="toc-why-r-is-our-chosen-lens" class="nav-link" data-scroll-target="#why-r-is-our-chosen-lens"><span class="header-section-number">1.5.2</span> Why R is Our Chosen Lens</a></li>
  <li><a href="#making-the-invisible-visible" id="toc-making-the-invisible-visible" class="nav-link" data-scroll-target="#making-the-invisible-visible"><span class="header-section-number">1.5.3</span> Making the Invisible Visible</a></li>
  <li><a href="#from-theory-to-reality-fast" id="toc-from-theory-to-reality-fast" class="nav-link" data-scroll-target="#from-theory-to-reality-fast"><span class="header-section-number">1.5.4</span> From Theory to Reality (Fast)</a></li>
  <li><a href="#the-power-of-the-tidy-workflow" id="toc-the-power-of-the-tidy-workflow" class="nav-link" data-scroll-target="#the-power-of-the-tidy-workflow"><span class="header-section-number">1.5.5</span> The Power of the “Tidy” Workflow</a></li>
  </ul></li>
  <li><a href="#case-study-the-rhythm-of-resilience" id="toc-case-study-the-rhythm-of-resilience" class="nav-link" data-scroll-target="#case-study-the-rhythm-of-resilience"><span class="header-section-number">1.6</span> Case Study: The Rhythm of Resilience</a>
  <ul class="collapse">
  <li><a href="#the-paradox-of-the-metronome" id="toc-the-paradox-of-the-metronome" class="nav-link" data-scroll-target="#the-paradox-of-the-metronome"><span class="header-section-number">1.6.1</span> The Paradox of the Metronome</a></li>
  <li><a href="#the-two-dancers-sympathetic-vs.-parasympathetic" id="toc-the-two-dancers-sympathetic-vs.-parasympathetic" class="nav-link" data-scroll-target="#the-two-dancers-sympathetic-vs.-parasympathetic"><span class="header-section-number">1.6.2</span> The Two Dancers: Sympathetic vs.&nbsp;Parasympathetic</a></li>
  <li><a href="#the-problem-seeing-the-unseen" id="toc-the-problem-seeing-the-unseen" class="nav-link" data-scroll-target="#the-problem-seeing-the-unseen"><span class="header-section-number">1.6.3</span> The Problem: Seeing the Unseen</a></li>
  <li><a href="#the-exercise-onset-challenge" id="toc-the-exercise-onset-challenge" class="nav-link" data-scroll-target="#the-exercise-onset-challenge"><span class="header-section-number">1.6.4</span> The “Exercise Onset” Challenge</a></li>
  <li><a href="#what-lies-ahead" id="toc-what-lies-ahead" class="nav-link" data-scroll-target="#what-lies-ahead"><span class="header-section-number">1.6.5</span> What Lies Ahead</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><ul><li><a href="https://github.com/matcasti/The-Physiological-Blueprint-Book/edit/main/01-why-model-physiology.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/matcasti/The-Physiological-Blueprint-Book/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">


<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./01-why-model-physiology.html">Foundations in Modeling and R</a></li><li class="breadcrumb-item"><a href="./01-why-model-physiology.html"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Why Model Physiology?</span></a></li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Why Model Physiology?</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="the-power-of-mathematical-modeling-in-biological-systems" class="level2" data-number="1.1">
<h2 data-number="1.1" class="anchored" data-anchor-id="the-power-of-mathematical-modeling-in-biological-systems"><span class="header-section-number">1.1</span> The Power of Mathematical Modeling in Biological Systems</h2>
<p>I remember the first time I saw a model “breathe”. I was sitting in the lab, staring at a jagged heart rate trace that made no sense. I wrote three lines of R code, pressed ‘Run’, and suddenly, a line in the plot cut through the noise with perfect, mathematical grace. It was like the ghost in the machine finally whispered its name to me. I wasn’t just looking at data anymore; I was looking at the blueprint of a human being.</p>
<p>I want you to take a second and think about the last time you went for a run or watched someone finish a sprint.</p>
<p>To the casual observer, it’s just movement, sweat, heavy breathing, and a look of sheer determination. But to us, it’s a symphony. Beneath the skin, there is a frantic, beautiful coordination happening. The lungs are expanding to capture oxygen; the heart is racing to distribute that oxygen to hungry muscles; the brain is firing signals to maintain balance and temperature. This is the architecture of life in its most active state.</p>
<p>But here’s the problem: if we only look at the runner from the outside, we only see the <em>outputs</em>. We see the heart rate on a smartwatch or the pace on a track. We don’t see the “why”. We don’t see the invisible gears, the feedback loops and the chemical signals, that make that performance possible. This is where we encounter the ghost in the machine. There is a logic to the chaos of biology, a set of rules that governs how our bodies react to the world.</p>
<p>Mathematical modeling is the process of sketching the blueprint of that ghost. It is the tool that allows us to move from being mere spectators of life to being architects of understanding.</p>
<section id="beyond-the-spreadsheet-the-living-system" class="level3" data-number="1.1.1">
<h3 data-number="1.1.1" class="anchored" data-anchor-id="beyond-the-spreadsheet-the-living-system"><span class="header-section-number">1.1.1</span> Beyond the Spreadsheet: The Living System</h3>
<p>In traditional physiology, we are often taught to think in snapshots. We learn that a resting heart rate is “X” and an exercising heart rate is “Y”. We look at tables, mean values, and standard deviations. This is useful, sure, but it’s static. It’s like trying to understand a movie by looking at a single frame.</p>
<p>The human body is never static. It is a dynamic, breathing, shifting entity. Every second, your physiological state is a result of what happened a millisecond ago and a predictor of what will happen a millisecond from now. This is the dance of life, the constant, elegant tug-of-war between the sympathetic “fight or flight” system and the parasympathetic “rest and digest” system.</p>
<p>When we model these systems, we stop looking at the “snapshots” and start looking at the “motion”. A mathematical model is, at its heart, a story told in the language of logic. It describes how one thing changes in response to another. Instead of saying “the heart rate increased”, a model allows us to say “the heart rate increased because the sympathetic drive overcame the vagal tone at a specific rate, influenced by the rising concentration of circulating catecholamines”.</p>
<p>By using math, we aren’t making biology colder or more abstract; we are actually getting closer to the truth of its complexity.</p>
</section>
<section id="the-power-of-simplification-the-map-and-the-territory" class="level3" data-number="1.1.2">
<h3 data-number="1.1.2" class="anchored" data-anchor-id="the-power-of-simplification-the-map-and-the-territory"><span class="header-section-number">1.1.2</span> The Power of Simplification (The Map and the Territory)</h3>
<p>There’s a famous trap that new modelers often fall into: they try to include <em>everything</em>. They want to model every single capillary, every individual neuron, and every molecular interaction. But a model that is as complex as the human body is just as difficult to understand as the human body itself.</p>
<p>Think of a map. If a map of a city were life-sized and contained every blade of grass and every pebble on the street, it wouldn’t be a map, it would just be the city. To be useful, a map must be a simplification. It must highlight the roads and the landmarks while ignoring the clutter.</p>
<p>This is the true power of mathematical modeling in physiology. It forces us to ask: What actually matters? When we start writing R code to simulate a cardiovascular system, we are making decisions about the “architecture of life”. We are deciding which variables are the pillars of the system and which are just the decorative molding. By stripping away the noise, we reveal the underlying mechanisms. If our simplified model can still predict how a heart reacts to a sudden sprint, then we know we’ve captured the essence of the system. We’ve found the blueprint.</p>
</section>
<section id="seeing-the-unseen-emergent-properties" class="level3" data-number="1.1.3">
<h3 data-number="1.1.3" class="anchored" data-anchor-id="seeing-the-unseen-emergent-properties"><span class="header-section-number">1.1.3</span> Seeing the Unseen: Emergent Properties</h3>
<p>One of the most mind-blowing aspects of biological modeling is something called <em>emergence</em>.</p>
<p>The body is a “system of systems”. Your heart is a pump, but it’s governed by your nervous system, which is influenced by your blood chemistry, which is regulated by your kidneys and lungs. Individually, these components are fascinating. But when you link them together in a model, something magical happens: the system starts to exhibit behaviors that none of the individual parts possess.</p>
<p>Consider Heart Rate Variability (HRV). If you look at a heart muscle cell in a petri dish, it just pulses. If you look at a single nerve, it just fires. But when you model the interaction between the heart and the autonomic nervous system, you suddenly see these complex, fractal-like rhythms emerge in the heart rate, rhythms that indicate health, stress, and resilience.</p>
<p>We call this “the ghost in the machine” because the behavior arises from the <em>interaction</em> of the parts, not the parts themselves. Without modeling, these emergent properties often seem like magic or random noise. With a model, we can trace the lines of logic and see exactly how the “dance of the nerves” creates the rhythm of the heart.</p>
</section>
<section id="why-this-book-and-why-now" class="level3" data-number="1.1.4">
<h3 data-number="1.1.4" class="anchored" data-anchor-id="why-this-book-and-why-now"><span class="header-section-number">1.1.4</span> Why This Book, and Why Now?</h3>
<p>I’m 26. I grew up in a world where data is everywhere. We have sensors on our wrists, rings on our fingers, and apps that track our sleep, our steps, and our strain. We are drowning in physiological data. But data without a model is just a pile of bricks.</p>
<p>In the past, modeling was reserved for the “math people”, the ones who spent their days in dusty offices writing Greek symbols on chalkboards. But the world has changed. We have R.</p>
<p>R is more than just a statistical language; it’s a laboratory. With modern packages, we can build a world, set the rules of physics (or physiology), and press “play”. We can simulate a patient with heart failure, an athlete at high altitude, or a person experiencing a panic attack, all within a few lines of code.</p>
<p>I’m writing this because I want to give you the keys to that laboratory. I want you to feel the same rush I feel when a model I’ve built starts to “breathe” on the screen. When the lines on the graph start to mimic the data we see in the real world, it’s an incredible feeling. It’s the moment you realize you’ve understood a piece of the architecture.</p>
</section>
<section id="the-path-ahead" class="level3" data-number="1.1.5">
<h3 data-number="1.1.5" class="anchored" data-anchor-id="the-path-ahead"><span class="header-section-number">1.1.5</span> The Path Ahead</h3>
<p>In this book, we aren’t going to get bogged down in dry, abstract proofs. I’m not going to ask you to solve a hundred equations by hand. That’s what the computer is for. Instead, we are going to focus on the logic.</p>
<p>We will learn how to:</p>
<ol type="1">
<li><strong>Identify the variables:</strong> What are the moving parts? (The “state variables”).</li>
<li><strong>Define the relationships:</strong> How does one part push or pull another? (The “rates of change”).</li>
<li><strong>Simulate the system:</strong> Using R to bring the equations to life.</li>
<li><strong>Listen to the model:</strong> What is the model telling us about the biology?</li>
</ol>
<p>Whether you are a student of kinesiology, a medical researcher, or just a data nerd who is fascinated by the human body, modeling will change the way you see the world. You will stop seeing “averages” and start seeing “dynamics”. You will stop seeing “bodies” and start seeing “blueprints”.</p>
<p>The architecture of life is complex, yes. It is messy and loud and sometimes confusing. But it is not random. It follows a dance, a beautiful, mathematical dance.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Feedback Loop
</div>
</div>
<div class="callout-body-container callout-body">
<p>At the core of almost every model we will build is the concept of <em>homeostasis</em>. The body doesn’t just “change”; it reacts to change to keep things stable. This is a feedback loop. Think of your thermostat at home:</p>
<ul>
<li><strong>Sensor:</strong> Measures the temperature.</li>
<li><strong>Controller:</strong> Decides if it’s too cold.</li>
<li><strong>Effector:</strong> Turns on the heater.</li>
</ul>
<p>In physiology, the “heater” might be your heart rate, and the “sensor” might be the baroreceptors in your neck. Modeling allows us to see how these loops prevent the system from spiraling out of control.</p>
</div>
</div>
</section>
</section>
<section id="the-role-of-models-in-hypothesis-generation-and-testing" class="level2" data-number="1.2">
<h2 data-number="1.2" class="anchored" data-anchor-id="the-role-of-models-in-hypothesis-generation-and-testing"><span class="header-section-number">1.2</span> The Role of Models in Hypothesis Generation and Testing</h2>
<p>I want you to imagine you’re standing in a high-performance physiology lab. It’s expensive, it’s clinical, and it’s filled with the hum of digital devices and the beeping of measurement equipment. You have a question, a “what if”. You wonder: <em>What if we could selectively dampen the parasympathetic “brake” on the heart during the first ten seconds of exercise without affecting the sympathetic “gas pedal”?</em> In the physical world, answering that is a nightmare. You’d need ethical clearances, a cohort of incredibly patient volunteers, and perhaps some very invasive (and likely impossible) pharmacological interventions. I’ve spent those months. I’ve lived in that hum. And trust me, while there’s a certain romance to the physical lab, there’s an unmatched power in being able to test a theory while the coffee in your mug is still hot. We’re moving the frontier of discovery from the treadmill to the silicon. By the time you’ve set up the experiment, months have passed, and you’ve spent thousands of dollars just to test one tiny branch of the autonomic nervous system.</p>
<p>But what if you didn’t have to start with the treadmill? What if you had a “virtual runner” living inside your laptop?</p>
<p>This is where the true power of modeling reveals itself. In this section, we’re going to talk about how models aren’t just pretty pictures or summaries of what we already know. They are hypothesis machines. They are the tools we use to explore the “what-ifs” of biology before we ever draw a drop of blood.</p>
<section id="the-what-if-machine-generating-new-ideas" class="level3" data-number="1.2.1">
<h3 data-number="1.2.1" class="anchored" data-anchor-id="the-what-if-machine-generating-new-ideas"><span class="header-section-number">1.2.1</span> The “What-If” Machine: Generating New Ideas</h3>
<p>Most people think science starts with an experiment. I’d argue that, in the modern age, it starts with a simulation.</p>
<p>When we build a model of a physiological system, say, the way the baroreflex regulates blood pressure, we are essentially writing down a formal hypothesis. Every equation we write is a claim: “I believe <em>this</em> variable influences <em>that</em> one in <em>this</em> specific way”.</p>
<p>Once that model is coded in R, it becomes a sandbox. You can start “tweaking” the parameters. You can turn the sympathetic gain up to 11. You can simulate a heart that has lost its elastic compliance. You can create a “ghost” of a person who doesn’t exist in the real world.</p>
<p>As you play with these virtual knobs, the model will often spit out behaviors you didn’t expect. You might find that at a certain intensity of exercise, the heart rate doesn’t just plateau; it starts to oscillate. That’s a “What-If” moment. You didn’t program that oscillation specifically; it emerged from the rules of the system.</p>
<p>Suddenly, you have a new hypothesis: <em>Does heart rate stability break down at near-maximal intensities due to a lag in autonomic feedback?</em> You didn’t find this by looking at old textbooks. You found it by exploring the logic of your model. This is hypothesis generation. The model has pointed its finger toward a corner of the physiology that you hadn’t considered looking at before.</p>
</section>
<section id="the-in-silico-laboratory-testing-without-the-treadmill" class="level3" data-number="1.2.2">
<h3 data-number="1.2.2" class="anchored" data-anchor-id="the-in-silico-laboratory-testing-without-the-treadmill"><span class="header-section-number">1.2.2</span> The In Silico Laboratory: Testing without the Treadmill</h3>
<p>Once you have a hypothesis, the model becomes your first line of testing. We call this <em>in silico</em> testing (literally “in silicon”, referring to the computer chips).</p>
<p>Testing a hypothesis in a model is like a flight simulator for a pilot. You wouldn’t put a trainee in a Boeing 747 and tell them to “see what happens” if an engine fails over the Atlantic. You put them in a simulator. Similarly, we can use our models to see if our biological theories even hold water mathematically.</p>
<p>Suppose you have a theory about why some athletes experience a “second wind”. You think it’s related to a specific delay in oxygen kinetics. You build the model, plug in the numbers, and run the simulation. If the model’s output looks nothing like a “second wind”, you’ve just saved yourself six months of lab work. Your hypothesis, in its current form, is mathematically impossible. If the model <em>does</em> show a second wind, you’ve just gained a massive amount of confidence. You now have a “proof of concept” that your logic is sound.</p>
<p>This “fail fast” mentality is common in the tech world, and it’s exactly how we should be approaching this <em>dance</em>. Why waste resources on an experiment that can’t even work in theory?</p>
</section>
<section id="falsifiability-and-the-wrong-model" class="level3" data-number="1.2.3">
<h3 data-number="1.2.3" class="anchored" data-anchor-id="falsifiability-and-the-wrong-model"><span class="header-section-number">1.2.3</span> Falsifiability and the “Wrong” Model</h3>
<p>Here is a bit of mentor-to-mentee philosophy: It is a good thing when your model is wrong.</p>
<p>In science, we talk a lot about “falsifiability”. A theory is only useful if there is a way to prove it’s incorrect. If I tell you that “the heart beats because of a magical spirit”, I haven’t given you a scientific theory, because there’s no way to test the spirit’s absence.</p>
<p>But if I give you a model that predicts a heart rate of 120 bpm under stress, and your real-world data shows 160 bpm, we have a beautiful, productive conflict. The model’s failure tells us exactly where our understanding of the architecture of the system is flawed. Is the sympathetic gain too low in our code? Did we forget a feedback loop? Is there a “ghost” in the real machine (a hidden variable) that we haven’t accounted for?</p>
<p>When the model doesn’t match the data, it’s not a “mistake”. It’s a map to a new discovery. Every time we refine the R code to better match the real-world heart rate trace, we are refining our understanding of life itself.</p>
</section>
<section id="case-in-point-autonomic-modulation" class="level3" data-number="1.2.4">
<h3 data-number="1.2.4" class="anchored" data-anchor-id="case-in-point-autonomic-modulation"><span class="header-section-number">1.2.4</span> Case in Point: Autonomic Modulation</h3>
<p>As we move through this book, we will focus heavily on how the brain talks to the heart. This “dance” is the perfect playground for hypothesis testing.</p>
<p>For instance, there is a long-standing debate about how much the “sympathetic” and “parasympathetic” branches actually interact. Are they purely additive (one goes up, the other goes down), or is there “accentuated antagonism” where one branch actively interferes with the other?</p>
<p>By the time you finish Part 2 of this book, you’ll be able to build two versions of a model: one where the branches are independent and one where they interact. You can run them both, compare them to a real R-R interval trace, and see which one “fits” better. In one afternoon, you can contribute to a debate that has lasted decades.</p>
<p>That is the power you have at your fingertips. We’re learning to think in dynamics. We’re learning to listen to the machine so we can understand the ghost.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Virtual Knockout
</div>
</div>
<div class="callout-body-container callout-body">
<p>In genetics, a “knockout” is an organism engineered to lack a specific gene to see what happens. In modeling, we perform “virtual knockouts”. We can set a specific parameter (like the rate of acetylcholine release) to exactly zero. This allows us to observe a “pure” sympathetic system, something that is almost impossible to achieve in a living, breathing human without causing a medical emergency.</p>
</div>
</div>
</section>
</section>
<section id="why-differential-equations-are-a-natural-language-for-physiology" class="level2" data-number="1.3">
<h2 data-number="1.3" class="anchored" data-anchor-id="why-differential-equations-are-a-natural-language-for-physiology"><span class="header-section-number">1.3</span> Why Differential Equations are a Natural Language for Physiology</h2>
<p>If you want to understand the architecture of life and biological systems, you have to stop thinking about what the body <em>is</em> and start thinking about what the body <em>does</em>.</p>
<p>Most of our educational lives, we are taught to categorize. We learn the names of the bones, the regions of the brain, and the layers of the heart. This is the study of “being”. But physiology is the study of “becoming”. Nothing in your body is truly still. Even as you sit here reading this, your blood is a river in constant motion, your neurotransmitters are crossing synapses in a frantic relay race, and your cells are burning fuel at a rate that shifts with every breath.</p>
<p>The problem with standard language, the kind we use to talk about our day or write a grocery list, is that it’s terrible at describing things that are constantly changing in relation to one another. If I say, “my heart rate is high”, I’m giving you a static data point. But if I want to describe the dance of the autonomic nervous system, how the heart rate climbs as the vagal tone withdraws and the sympathetic drive kicks in, I need a language that can handle the “flux”.</p>
<p>That language is the Differential Equation.</p>
<p>Don’t let the word ‘Equation’ scare you off. We aren’t here to do math for the sake of math; we’re here to give the ghost a voice. In our world, an equation is just a sentence that refuses to be static.</p>
<section id="the-speedometer-of-the-soul" class="level3" data-number="1.3.1">
<h3 data-number="1.3.1" class="anchored" data-anchor-id="the-speedometer-of-the-soul"><span class="header-section-number">1.3.1</span> The Speedometer of the Soul</h3>
<p>I like to think of Ordinary Differential Equations (ODEs) as the “speedometers” of the biological world.</p>
<p>Think about driving a car. You have two main pieces of information: where you are (your position) and how fast you’re going (your velocity). In physiology, the “where you are” is your current state, your current blood glucose level, your current heart rate, or the current concentration of lactate in your muscles. The “how fast you’re going” is the rate of change.</p>
<p>An ODE is simply a mathematical sentence that links the two. It says: “The rate at which this thing changes depends on the state it’s currently in (and perhaps some outside forces)”.</p>
<p>In a spreadsheet, you might see data points at minute 1, minute 2, and minute 3. But the body doesn’t live in minute-long chunks. It lives in the infinitesimal gaps between those minutes. Differential equations allow us to peer into those gaps. They treat time not as a series of steps, but as a smooth, continuous flow. This is why they feel so “natural” when applied to biology; they respect the continuity of life.</p>
</section>
<section id="the-logic-of-the-feedback-loop" class="level3" data-number="1.3.2">
<h3 data-number="1.3.2" class="anchored" data-anchor-id="the-logic-of-the-feedback-loop"><span class="header-section-number">1.3.2</span> The Logic of the Feedback Loop</h3>
<p>The most profound reason ODEs are the natural language of physiology is that they are built for feedback. As we discussed earlier, the ghost in the machine is usually a feedback loop.</p>
<p>Let’s look at a classic example: the regulation of blood sugar. When you eat a donut, your blood glucose (<span class="math inline">\(G\)</span>) rises. This rise in glucose triggers your pancreas to release insulin (<span class="math inline">\(I\)</span>). The insulin then acts like a key, opening up your cells to pull the glucose out of the bloodstream, which causes the glucose level to drop.</p>
<p>If we were to write this in prose, it’s a bit clunky. If we were to put it in a table, it’s a series of “if-then” statements. But in the language of ODEs, it becomes a beautiful, symmetrical system:</p>
<ol type="1">
<li>The rate of change of Glucose (<span class="math inline">\(\frac{dG}{dt}\)</span>) is decreased by the amount of Insulin (<span class="math inline">\(I\)</span>).</li>
<li>The rate of change of Insulin (<span class="math inline">\(\frac{dI}{dt}\)</span>) is increased by the amount of Glucose (<span class="math inline">\(G\)</span>).</li>
</ol>
<p>This is the “blueprint” of a homeostatic system. The equations don’t just tell us what the levels are; they tell us how the levels <em>interact</em>. They describe a relationship where the “speed” of the response is proportional to the “size” of the problem. This is exactly how your body operates. It doesn’t just turn a switch on or off; it modulates. It’s a dimmer switch, not a toggle, and ODEs are the only way to describe that dimming effect accurately.</p>
</section>
<section id="the-ghost-in-the-differential" class="level3" data-number="1.3.3">
<h3 data-number="1.3.3" class="anchored" data-anchor-id="the-ghost-in-the-differential"><span class="header-section-number">1.3.3</span> The “Ghost” in the Differential</h3>
<p>One of my favorite things about ODEs is that they reveal the “hidden” forces in a system. In a simple equation like <span class="math inline">\(\frac{dx}{dt} = kx\)</span>, the “x” is the part we can see (the state), but the “k” is the architecture. That <span class="math inline">\(k\)</span> represents the properties of the tissue, the sensitivity of the receptors, or the efficiency of the enzymes.</p>
<p>When we try to model latent behavior like the autonomic nervous system’s influence on the heart, we aren’t just plotting a line; we are trying to find the value of those hidden parameters.</p>
<p>Take the heart rate response at the onset of exercise. If you stand up and start sprinting, your heart rate doesn’t instantly jump from 60 to 160. It follows a curve. That curve is defined by a differential equation. The “steepness” of that curve, how fast you reach your steady state, tells us something profound about your autonomic health. A “fast” heart rate response suggests a nimble, responsive nervous system. A “sluggish” response might suggest fatigue or overtraining.</p>
<p>By using ODEs, we move beyond asking “What is the heart rate?” and start asking “How responsive is the system?” We are measuring the <em>vitality</em> of the ghost, not just the dimensions of the machine.</p>
</section>
<section id="continuity-in-a-discrete-world" class="level3" data-number="1.3.4">
<h3 data-number="1.3.4" class="anchored" data-anchor-id="continuity-in-a-discrete-world"><span class="header-section-number">1.3.4</span> Continuity in a Discrete World</h3>
<p>We live in a digital age. We’re used to pixels, frames per second, and discrete “bits” of information. Because of this, it’s tempting to think of physiology as a series of discrete events: a heartbeat, a breath, a muscle twitch.</p>
<p>But biology is fundamentally continuous. The transition from rest to exercise is a slide, not a jump. The fading of a drug’s effect in the liver is a slow taper, not a sudden disappearance.</p>
<p>When we use R to solve these equations (which we’ll start doing in Chapter 5), the computer actually has to work quite hard to mimic this continuity. It takes tiny, tiny steps to approximate the smooth flow of the real world. But the <em>logic</em> we provide the computer, the ODE, is continuous. It assumes that for every billionth of a second, there is a corresponding billionth of a change.</p>
<p>This is why ODEs are so much more powerful than simple linear regression or static statistics. Statistics looks at the “what happened”. ODEs look at the “how it happens”. They allow us to simulate the <em>process</em> of living.</p>
</section>
<section id="embracing-the-complexity" class="level3" data-number="1.3.5">
<h3 data-number="1.3.5" class="anchored" data-anchor-id="embracing-the-complexity"><span class="header-section-number">1.3.5</span> Embracing the Complexity</h3>
<p>I know that for many, the word “equation” brings up memories of dry classrooms and confusing symbols. But I want you to look at these equations as a form of poetry. A differential equation is a way of saying, “the future of this system is contained within its present”.</p>
<p>In the chapters to come, we are going to look at the architecture of dynamics through these equations. We’ll see how:</p>
<ul>
<li><strong>Pressure and Flow</strong> in your arteries are locked in a differential embrace.</li>
<li><strong>Oxygen Uptake</strong> in your lungs follows a predictable rate of change.</li>
<li><strong>Autonomic Balance</strong> is a system of coupled equations where the sympathetic and parasympathetic nerves are constantly trying to find a moving equilibrium.</li>
</ul>
<p>We aren’t doing math for the sake of math. We are doing it because we want to speak the body’s native tongue. We want to understand why the heart dances the way it does, and why the ghost in the machine sometimes loses its rhythm.</p>
<p>So, don’t fear the <span class="math inline">\(\frac{dy}{dt}\)</span>. See it for what it is: a tiny, mathematical heartbeat. It is the pulse of the model, and it’s what’s going to allow us to build simulations that don’t just look like life, but <em>behave</em> like it.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
ODEs vs.&nbsp;Machine Learning
</div>
</div>
<div class="callout-body-container callout-body">
<p>You’ll hear a lot of buzz today about “Black Box” AI and Machine Learning. Those tools are great for predicting <em>what</em> will happen based on massive amounts of data. But they don’t tell you <em>how</em>. An ODE model is “White Box”. It’s transparent. Every term in your R code corresponds to a physical reality, a valve, a nerve, a chemical gradient. If you want to truly <em>understand</em> physiology, you don’t want a black box; you want a blueprint.</p>
</div>
</div>
<p>Now that we have the language, let’s look at the poems already written by the giants of our field.</p>
</section>
</section>
<section id="examples-of-classic-physiological-models" class="level2" data-number="1.4">
<h2 data-number="1.4" class="anchored" data-anchor-id="examples-of-classic-physiological-models"><span class="header-section-number">1.4</span> Examples of Classic Physiological Models</h2>
<p>Before we start building our own complex architectures in R, we need to pay our respects to the giants whose shoulders we’re standing on. You see, the architecture of life isn’t a new discovery. For decades, brilliant minds have been trying to capture the ghost in the machine using nothing but pen, paper, and the logic of differential equations.</p>
<p>In this section, we’re going to walk through a few “Greatest Hits”. These aren’t just dry historical artifacts; they are the foundational blueprints for almost everything we do in modern modeling. Whether you’re tracking a virus through a population or a drug through a kidney, the underlying math often traces back to these classic forms.</p>
<section id="the-simplest-blueprint-exponential-growth-and-decay" class="level3" data-number="1.4.1">
<h3 data-number="1.4.1" class="anchored" data-anchor-id="the-simplest-blueprint-exponential-growth-and-decay"><span class="header-section-number">1.4.1</span> The Simplest Blueprint: Exponential Growth and Decay</h3>
<p>The most fundamental “movement” in biology is the change that depends directly on the current state. Imagine a colony of bacteria in a petri dish with infinite snacks. The more bacteria there are, the more they reproduce. The rate of change is proportional to the population size.</p>
<p>Mathematically, we write this as:</p>
<p><span class="math display">\[\frac{dN}{dt} = rN\]</span></p>
<p>Here, <span class="math inline">\(N\)</span> is the number of bacteria, and <span class="math inline">\(r\)</span> is the growth rate. This is the “Pure Growth” model. It’s the simplest way to describe a system that is running away with itself.</p>
<p>But biology rarely lets things run away forever. Eventually, the petri dish runs out of space or food. This is where we move from the exponential to the logistic model. We add a “braking” term that slows the growth as the population approaches a carrying capacity (<span class="math inline">\(K\)</span>).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Beauty of the “Wrong” Model
</div>
</div>
<div class="callout-body-container callout-body">
<p>The original Malthusian growth model (<span class="math inline">\(\frac{dN}{dt} = rN\)</span>) is “wrong” because it predicts infinite populations. But it’s the most important model ever written because it provided the <em>starting point</em>. In physiology, we often start with the simplest (and technically “wrong”) model because it allows us to see the primary force clearly before we add the complications of reality.</p>
</div>
</div>
<p>Why does this matter for a heart rate mentor? Because this “growth and brake” logic is the same logic used to model how a signal spreads through a neural network or how a physiological variable returns to baseline after a disturbance. It’s the first step in understanding the dance of the nerves.</p>
</section>
<section id="the-coffee-model-pharmacokinetics-and-drug-clearance" class="level3" data-number="1.4.2">
<h3 data-number="1.4.2" class="anchored" data-anchor-id="the-coffee-model-pharmacokinetics-and-drug-clearance"><span class="header-section-number">1.4.2</span> The “Coffee” Model: Pharmacokinetics and Drug Clearance</h3>
<p>Let’s get more personal. Think about that cup of coffee you had this morning. The moment you finished it, your liver started a very specific task: getting rid of the caffeine.</p>
<p>Your body doesn’t clear 10mg of caffeine per hour. Instead, it clears a <em>percentage</em> of what is currently in your blood. This is called “First-Order Kinetics”. The less caffeine you have left, the slower the clearance becomes.</p>
<p>If <span class="math inline">\(C\)</span> is the concentration of caffeine in your blood, the model looks like this:</p>
<p><span class="math display">\[\frac{dC}{dt} = -kC\]</span></p>
<p>The negative sign tells us the concentration is decreasing. The <span class="math inline">\(k\)</span> is the clearance constant, a parameter that represents the efficiency of your enzymes.</p>
<p>In R, simulating this is trivial, but the insight is profound. It explains why a drug stays in your system for a long time (the “long tail”) and why “half-life” is such a critical concept in medicine. This simple ODE is the backbone of the entire field of pharmacokinetics. When we eventually model how adrenaline (epinephrine) clears from the heart after a sprint, we will be using this exact same blueprint.</p>
</section>
<section id="predator-and-prey-a-metaphor-for-autonomic-balance" class="level3" data-number="1.4.3">
<h3 data-number="1.4.3" class="anchored" data-anchor-id="predator-and-prey-a-metaphor-for-autonomic-balance"><span class="header-section-number">1.4.3</span> Predator and Prey: A Metaphor for Autonomic Balance</h3>
<p>This is where things get really interesting. In the early 20th century, two mathematicians named Lotka and Volterra developed a model to describe the population dynamics of lynx (predators) and hares (prey).</p>
<ol type="1">
<li><strong>The Hares</strong> grow exponentially if there are no lynx.</li>
<li><strong>The Lynx</strong> die off if there are no hares to eat.</li>
<li>When they meet, the lynx eat the hares, increasing the lynx population and decreasing the hare population.</li>
</ol>
<p>This creates a beautiful, oscillating cycle. As the hares increase, the lynx have more food and their population booms. But then they eat too many hares, the food supply crashes, the lynx starve, and the hares get a chance to recover.</p>
<p>Now, you might be wondering: <em>What does a lynx eating a hare have to do with my heart rate?</em></p>
<p>Everything. I want you to think of the sympathetic and parasympathetic systems as a predator-prey relationship. The sympathetic system (the predator) drives the heart rate up, while the parasympathetic system (the prey/the brake) tries to keep things in check. They are constantly “feeding” off each other’s signals to maintain a dynamic balance.</p>
<p>While the actual math of the heart is more complex (we’ll get there in Part 3!), the Lotka-Volterra model was the first time we realized that two simple, coupled differential equations could create complex, rhythmic behavior. It proved that you don’t need a “conductor” to create a rhythm; the rhythm is an emergent property of the system’s architecture.</p>
</section>
<section id="the-hodgkin-huxley-model-the-ghost-in-the-nerve" class="level3" data-number="1.4.4">
<h3 data-number="1.4.4" class="anchored" data-anchor-id="the-hodgkin-huxley-model-the-ghost-in-the-nerve"><span class="header-section-number">1.4.4</span> The Hodgkin-Huxley Model: The Ghost in the Nerve</h3>
<p>We can’t talk about classic models without mentioning the big one: the 1952 Hodgkin-Huxley model of the action potential. This is arguably the most famous model in the history of biology.</p>
<p>Before this model, we knew that nerves fired electrical signals, but we didn’t really know <em>how</em>. Hodgkin and Huxley sat down with a giant squid axon (because the nerves were big enough to poke with needles) and described the flow of sodium and potassium ions using a set of four coupled differential equations.</p>
<p>They modeled the cell membrane as an electrical circuit, with resistors, capacitors, and batteries. The <strong>Capacitor</strong> is the cell membrane itself, holding a charge. The <strong>Resistors</strong> are the ion channels, which “resist” or “allow” the flow of ions.</p>
<p>This model won them a Nobel Prize because it didn’t just <em>describe</em> the nerve signal; it <em>explained</em> it. It showed that the “spike” of a nerve impulse is just the result of voltage-gated channels opening and closing at different rates.</p>
<p>When I talk about the architecture of life, this is what I mean. Hodgkin and Huxley looked at a messy biological fiber and saw a circuit board. They found the code.</p>
<p>Think about that, a Nobel prize for seeing the soul of a nerve in the logic of a battery. That’s the kind of architecture we’re hunting for.</p>
<p>I know that now you might be tempted to skip these and go straight to the “modern” stuff. However, modern models are just these classics wearing a fancy coat. When we model blood pressure, we’re using the “Growth and Brake” logic. When we model hormone signaling, we’re using “Drug Clearance” kinetics. When we model Heart Rate Variability, we’re building on the “Oscillation” principles of predator-prey systems.</p>
<p>By understanding these classics, you develop an intuition for the “shapes” of change. You start to see a graph and think, <em>“Ah, that’s a first-order decay”,</em> or <em>“That looks like a coupled oscillation”.</em> You begin to read the language of the body.</p>
<p>In the next section, we’re going to talk about why we need a tool like R to make these blueprints come to life. Because while Lotka and Volterra had to solve these by hand, you have the power of a thousand mathematicians in your RStudio console.</p>
<p>I don’t want you to memorize the Lotka-Volterra equations. I want you to remember the <em>shape</em> of the curve. In R, we can change the parameters and watch the oscillations get wider or narrower in real-time. That visual “click” in your brain is worth more than a thousand memorized formulas.</p>
</section>
</section>
<section id="the-importance-of-computational-tools-like-r-for-solving-and-visualizing-models" class="level2" data-number="1.5">
<h2 data-number="1.5" class="anchored" data-anchor-id="the-importance-of-computational-tools-like-r-for-solving-and-visualizing-models"><span class="header-section-number">1.5</span> The Importance of Computational Tools (Like R) for Solving and Visualizing Models</h2>
<p>I want you to picture a scene from a movie set in the 1950s. A scientist is hunched over a massive chalkboard, frantically scrawling Greek symbols, erasing them, and scrawling more. He’s trying to find the “analytical solution”, a single, perfect mathematical formula that describes everything.</p>
<p>If that scientist were trying to model the human heart, he would likely stay hunched over that chalkboard for the rest of his life.</p>
<p>Why? Because biology is stubborn. It is nonlinear, it is interconnected, and it rarely follows the neat, solvable paths we find in introductory physics textbooks. In the real world, most of the differential equations that describe living systems simply cannot be solved by hand. They don’t have a “clean” answer that you can circle in red pen.</p>
<p>This is where the keyboard becomes more powerful than the chalk. To truly understand the latent drive that makes the machine works, we need a computational partner. We need R.</p>
<section id="the-blackboard-barrier-why-we-cant-do-it-alone" class="level3" data-number="1.5.1">
<h3 data-number="1.5.1" class="anchored" data-anchor-id="the-blackboard-barrier-why-we-cant-do-it-alone"><span class="header-section-number">1.5.1</span> The Blackboard Barrier: Why We Can’t Do It Alone</h3>
<p>In your earlier math classes, you probably solved “toy” problems. You were given an equation, and you used integration to find a function. That works fine for a falling rock or a simple bank account interest rate.</p>
<p>But physiology is a different beast. Imagine trying to write a single formula for your heart rate as it responds to:</p>
<ol type="1">
<li>The sudden surge of adrenaline as you start a race.</li>
<li>The feedback from baroreceptors noticing a change in blood pressure.</li>
<li>The temperature of your blood rising.</li>
<li>The accumulation of CO2 in your lungs.</li>
</ol>
<p>In the language of math, these are “coupled, nonlinear systems”. When you change one thing, everything else shifts in a way that isn’t a straight line. If you try to solve these by hand, you hit the “Blackboard Barrier”. The math becomes so complex that the human brain, brilliant as it is, simply runs out of RAM.</p>
<p>Human intuition is great at predicting linear changes (if I walk twice as fast, I’ll get there in half the time). But we are terrible at predicting nonlinear feedback. We often overestimate short-term changes and underestimate the long-term “tipping points” in a system. Computational tools act as an “intuition prosthetic”, helping us see around the corners of complex biological logic.</p>
<p>Computational tools like R don’t try to find that “one perfect formula”. Instead, they use numerical methods. They solve the equation by taking millions of tiny, infinitesimal steps forward in time. They ask, “Based on where the heart is <em>right now</em>, where will it be in the next 0.001 seconds?” and then they do it again, and again, and again.</p>
</section>
<section id="why-r-is-our-chosen-lens" class="level3" data-number="1.5.2">
<h3 data-number="1.5.2" class="anchored" data-anchor-id="why-r-is-our-chosen-lens"><span class="header-section-number">1.5.2</span> Why R is Our Chosen Lens</h3>
<p>You might ask, “Why R? Why not Python, or MATLAB, or some specialized medical software?”</p>
<p>I’m 26. I grew up in the era of open-source collaboration. To me, R isn’t just a programming language; it’s a global conversation. When you use R, you aren’t just using a tool; you’re tapping into the collective brainpower of thousands of scientists who have already figured out the hardest parts of the coding for you.</p>
<p>Here is why R is the perfect lens (at least for me):</p>
<ol type="1">
<li><strong>The Ecosystem of Packages:</strong> In R, we don’t have to build our “solvers” from scratch. We give it the “rules” of our physiology, and it handles the heavy lifting of the millions of tiny steps.</li>
<li><strong>Visualization as Insight:</strong> In physiology, a table of numbers is a graveyard of data. It’s dead. To make it live, we need to see it. With <code>ggplot2</code>, we can turn abstract equations into high-fidelity visuals. We can see the sympathetic system “climbing” and the parasympathetic system “falling” in real-time.</li>
<li><strong>Reproducibility:</strong> This is huge. In the past, if a scientist built a model, you had to take their word for it. Today, I can send you my R script, and you can run the exact same simulation on your laptop. We can “interrogate” each other’s thought process.</li>
</ol>
</section>
<section id="making-the-invisible-visible" class="level3" data-number="1.5.3">
<h3 data-number="1.5.3" class="anchored" data-anchor-id="making-the-invisible-visible"><span class="header-section-number">1.5.3</span> Making the Invisible Visible</h3>
<p>The most important reason we use computational tools is to visualize emergent properties.</p>
<p>Think back to the “predator-prey” model of the hares and lynx. If I just show you the equations, your brain probably doesn’t immediately see a cycle. But when we pipe those equations through R and plot them, a beautiful, rhythmic oscillation appears on the screen.</p>
<p>Suddenly, the math isn’t an obstacle. You see how the heart rate “hunts” for its equilibrium. By using R to visualize our models, we are effectively giving ourselves “X-ray vision” for biological logic. We can see the invisible forces that govern our breath and our pulse.</p>
</section>
<section id="from-theory-to-reality-fast" class="level3" data-number="1.5.4">
<h3 data-number="1.5.4" class="anchored" data-anchor-id="from-theory-to-reality-fast"><span class="header-section-number">1.5.4</span> From Theory to Reality (Fast)</h3>
<p>In a lab, an experiment might take weeks. In R, a simulation takes milliseconds.</p>
<p>This speed changes the way you think. When the “cost” of being wrong is just a few seconds of compute time, you become more adventurous. You start asking more “What-If” questions. What if I double the resistance in the femoral artery? What if the vagus nerve is 20% less sensitive? What if this athlete is dehydrated?</p>
<p>Computational tools allow us to iterate at the speed of thought. We can build, break, and rebuild a hundred times before lunch. This is how we move from being “students of physiology” to being “explorers of systems”.</p>
</section>
<section id="the-power-of-the-tidy-workflow" class="level3" data-number="1.5.5">
<h3 data-number="1.5.5" class="anchored" data-anchor-id="the-power-of-the-tidy-workflow"><span class="header-section-number">1.5.5</span> The Power of the “Tidy” Workflow</h3>
<p>Throughout this book, we will use what’s called a “Tidy” approach. We’ll organize our model outputs into clean data frames that play nicely with the modern R ecosystem. This isn’t just about being neat; it’s about power. By keeping our data “tidy”, we can easily compare ten different versions of a model at once, or overlay our virtual “ghost” simulations directly onto real data collected from a heart rate monitor.</p>
<p>I’ve learned the hard way that messy code leads to a messy understanding (and that leads to double the work). When we tidy our data, we’re actually tidying our perception of the biological world. It’s about making the architecture visible, not just functional.</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th style="text-align: left;">Traditional Modeling</th>
<th style="text-align: left;">Modern R Modeling</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Hand-written proofs</td>
<td style="text-align: left;">Coded functions</td>
</tr>
<tr class="even">
<td style="text-align: left;">Static “snapshots”</td>
<td style="text-align: left;">Dynamic simulations</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Opaque “Black Box”</td>
<td style="text-align: left;">Transparent, reproducible code</td>
</tr>
<tr class="even">
<td style="text-align: left;">Fixed assumptions</td>
<td style="text-align: left;">Rapid parameter “sweeps”</td>
</tr>
</tbody>
</table>
<p>I know that if you haven’t coded before, looking at an RStudio console can feel like looking at the matrix. It seems cold and intimidating.</p>
<p>But remember: R is just a way to talk to the machine. And the machine is just a way to talk to the biology. We aren’t learning code for the sake of becoming “programmers”. We are learning code so we can be better physiologists. We are learning to use the most advanced tools available to understand the most ancient and beautiful architecture in existence.</p>
<p>Don’t worry about the syntax yet. We’ll walk through that together in the next chapter. For now, just recognize that R is the “engine” that is going to bring our equations to life. It’s the tool that’s going to let us see the ghost.</p>
<p>We have the engine (R) and the language (ODEs). Let’s finally meet our protagonist: the human heart.</p>
</section>
</section>
<section id="case-study-the-rhythm-of-resilience" class="level2" data-number="1.6">
<h2 data-number="1.6" class="anchored" data-anchor-id="case-study-the-rhythm-of-resilience"><span class="header-section-number">1.6</span> Case Study: The Rhythm of Resilience</h2>
<p>Before we close the curtain on this introductory chapter and open our laptops to start typing R code, I want to give you something real to chew on. We’ve talked about the “why” and the “how” in the abstract, but the rythm of life is best understood through a specific mystery.</p>
<p>Throughout this book, we will return to a recurring protagonist: the human heart. But we aren’t just looking at the heart as a pump; we are looking at it as the ultimate interface, the place where the physical body meets the electrical signals of the brain. We are going to investigate the cardiac autonomic modulation (CAM) system.</p>
<p>If you want to see the ghost that makes the machinery works, there is no better place to look than the space between two heartbeats.</p>
<section id="the-paradox-of-the-metronome" class="level3" data-number="1.6.1">
<h3 data-number="1.6.1" class="anchored" data-anchor-id="the-paradox-of-the-metronome"><span class="header-section-number">1.6.1</span> The Paradox of the Metronome</h3>
<p>Imagine you’re sitting in a quiet room, perfectly still. You place two fingers on your radial pulse. You feel it: <em>thump… thump… thump…</em> It feels steady. It feels like a clock. For decades, clinicians looked at that pulse and recorded a single number, maybe 60 beats per minute (bpm). I remember looking at my first HRV trace and thinking the sensor was broken. It was too ‘noisy’. But that noise wasn’t a glitch; it was the dance of the nerves in real-time. They treated the heart like a metronome.</p>
<p>But here is the secret: a healthy heart is <em>not</em> a metronome. If your heart rate were perfectly regular, with exactly 1.000 seconds between every single beat, you would likely be in a state of severe physiological distress, or perhaps nearing the end of your life.</p>
<p>This <em>dance</em> demands a certain level of chaos. In a healthy person, the time interval between beats is constantly shifting. One interval might be 0.92 seconds, the next 1.05 seconds, and the one after that 0.88 seconds. This is Heart Rate Variability (HRV), and it is the outward “whisper” of the autonomic nervous system.</p>
<p>Our case study is built around a single, driving question: <em>How does the interaction between the sympathetic “accelerator” and the parasympathetic “brake” create the complex rhythms we see during the transition from rest to exercise?</em></p>
</section>
<section id="the-two-dancers-sympathetic-vs.-parasympathetic" class="level3" data-number="1.6.2">
<h3 data-number="1.6.2" class="anchored" data-anchor-id="the-two-dancers-sympathetic-vs.-parasympathetic"><span class="header-section-number">1.6.2</span> The Two Dancers: Sympathetic vs.&nbsp;Parasympathetic</h3>
<p>To model this, we have to understand the two main characters in our story. First is the Parasympathetic Branch (The Vagus Nerve). This is the “rest and digest” system. I like to think of it as the refined, elegant dancer. It uses a neurotransmitter called acetylcholine, which works incredibly fast. The vagus nerve can slow the heart down almost instantly, within a single beat. It is the “brake” that is constantly being tapped and released to keep your heart from racing away. Second, is the Sympathetic Branch. This is the “fight or flight” system. It’s the powerhouse. It uses norepinephrine (and adrenaline from the adrenal glands). Unlike the vagus nerve, the sympathetic system is slow to start but has a long-lasting effect. It’s like a massive steam engine; it takes time to stoke the fires, but once it’s moving, it’s hard to stop.</p>
<p>In every second of your life, these two branches are engaged in a tug-of-war over the Sinoatrial (SA) node, the heart’s natural pacemaker. This is the cardiac autonomic modulation.</p>
<p>When you decide to stand up and walk across the room, your brain doesn’t just send a “go faster” signal. It performs a complex, coordinated move: it first “withdraws” the vagal brake, allowing the heart rate to jump up quickly, and then it slowly “increases” the sympathetic gas pedal to sustain that higher rate.</p>
</section>
<section id="the-problem-seeing-the-unseen" class="level3" data-number="1.6.3">
<h3 data-number="1.6.3" class="anchored" data-anchor-id="the-problem-seeing-the-unseen"><span class="header-section-number">1.6.3</span> The Problem: Seeing the Unseen</h3>
<p>If we want to understand an athlete’s recovery or a patient’s stress levels, we want to know the “tone” of these two nerves. But here is the catch: we can’t easily stick electrodes into the vagus nerve of a living human. We can see the <em>result</em> (the heart rate), but we can’t see the <em>inputs</em> (the neural firing).</p>
<p>This is why we model.</p>
<p>We can build a system of Ordinary Differential Equations where:</p>
<ul>
<li>One equation describes the concentration of acetylcholine (the brake fluid).</li>
<li>One equation describes the concentration of norepinephrine (the fuel).</li>
<li>A third equation describes how the SA node integrates these two signals to produce a heartbeat.</li>
</ul>
<p>By adjusting the parameters of this model in R, we can simulate different “types” of people. We can create a model of a highly-trained marathoner (whose vagal brake is incredibly strong) and compare it to a model of a stressed-out office worker (whose sympathetic engine is constantly idling at high RPMs).</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
The Vagal Tone
</div>
</div>
<div class="callout-body-container callout-body">
<p>The reason your resting heart rate isn’t 100 bpm (the natural “un-nerved” rhythm of the heart) is because of the vagus nerve. You are currently under “vagal restraint”. Your brain is actively holding your heart back. When you start to exercise, the fastest way to speed up isn’t to work harder, but to simply <em>stop holding back</em>. This is a fundamental principle of biological efficiency.</p>
</div>
</div>
<p>I chose this case study because it’s a “multi-scale” problem. It involves molecules (neurotransmitters), organs (the heart), and the whole organism (the runner). If you can model this, you can model almost anything in physiology. Throughout the book, when the math gets a bit heavy, just think back to the sprinter at the starting line. Everything we do is for that moment.</p>
</section>
<section id="the-exercise-onset-challenge" class="level3" data-number="1.6.4">
<h3 data-number="1.6.4" class="anchored" data-anchor-id="the-exercise-onset-challenge"><span class="header-section-number">1.6.4</span> The “Exercise Onset” Challenge</h3>
<p>Our specific case study focuses on the first 60 seconds of exercise.</p>
<p>Think about what happens when a sprinter hears the starting pistol. In those first few seconds, the heart rate skyrockets. But is that increase due to the brake being released, or the gas pedal being pushed? Or both?</p>
<p>Current physiological theory suggests a “phased” response:</p>
<ul>
<li><strong>Phase 1 (0-10 seconds):</strong> Pure vagal withdrawal. The brake is lifted.</li>
<li><strong>Phase 2 (10-60 seconds):</strong> Sympathetic activation kicks in. The gas pedal is pressed.</li>
</ul>
<p>If we can build a model that replicates this “S-curve” of heart rate increase, we can start to test hypotheses. For example: <em>If a person has a “blunted” heart rate response, is it because their vagus nerve isn’t withdrawing properly, or because their sympathetic system is sluggish?</em></p>
<p>This isn’t just academic. In the world of sports science, “Heart Rate Recovery”, how fast your heart rate drops in the first minute after exercise, is one of the best predictors of fitness and even longevity. By modeling the blueprint of life behind that recovery, we can move from simply saying “your recovery is slow” to saying “your vagal reactivation is delayed by X seconds”.</p>
</section>
<section id="what-lies-ahead" class="level3" data-number="1.6.5">
<h3 data-number="1.6.5" class="anchored" data-anchor-id="what-lies-ahead"><span class="header-section-number">1.6.5</span> What Lies Ahead</h3>
<p>In the chapters to come, we will build the pieces of this case study step-by-step: 1. <strong>Chapter 3 &amp; 4:</strong> We’ll learn the math of “rates” so we can describe how fast acetylcholine disappears. 2. <strong>Chapter 9:</strong> We’ll build the basic cardiovascular “pump” model. 3. <strong>Chapter 10 &amp; 12:</strong> We’ll finally wire the “nerves” to the “pump” and run our full exercise simulations.</p>
<p>Before we move on to Chapter 2 and start our R setup, I want you to remember this: every line of code you write is a step toward understanding how we maintain balance in a world that is constantly trying to push us off-center. We are building the blueprint of resilience.</p>
<p>Are you ready to see the ghost? Take a breath. Feel your own heart rate, that’s the system we’re about to build. I’ll see you in Chapter 2, where we turn this philosophy into code</p>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    // Ensure there is a toggle, if there isn't float one in the top right
    if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
      const a = window.document.createElement('a');
      a.classList.add('top-right');
      a.classList.add('quarto-color-scheme-toggle');
      a.href = "";
      a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
      const i = window.document.createElement("i");
      i.classList.add('bi');
      a.appendChild(i);
      window.document.body.appendChild(a);
    }
    setColorSchemeToggle(hasAlternateSentinel())
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./preface.html" class="pagination-link" aria-label="Preface">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Preface</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./02-a_gentle_introduction_to_r_for_modelers.html" class="pagination-link" aria-label="A Gentle Introduction to R for Modelers">
        <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">A Gentle Introduction to R for Modelers</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Made with <i class="fa-solid fa-heart" style="color: #ff0000;"></i> by Matías Castillo-Aguilar</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    <div class="toc-actions d-sm-block d-md-none"><ul><li><a href="https://github.com/matcasti/The-Physiological-Blueprint-Book/edit/main/01-why-model-physiology.qmd" class="toc-action"><i class="bi bi-github"></i>Edit this page</a></li><li><a href="https://github.com/matcasti/The-Physiological-Blueprint-Book/issues/new" class="toc-action"><i class="bi empty"></i>Report an issue</a></li></ul></div></div>
    <div class="nav-footer-right">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/matcasti">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://bayesically-speaking.com/">
      <i class="bi bi-globe" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item">
    <a class="nav-link" href="https://orcid.org/0000-0001-7291-247X">
<p><i class="fa-brands fa-orcid" aria-label="orcid"></i></p>
</a>
  </li>  
</ul>
    </div>
  </div>
</footer>




</body></html>